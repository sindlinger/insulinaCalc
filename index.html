<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Insulina</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --primary-light: #e8f4fc;
            --primary-dark: #2980b9;
            --accent-color: #f39c12;
            --danger-color: #e74c3c;
            --success-color: #2ecc71;
            --text-color: #333;
            --light-text: #666;
            --very-light-text: #999;
            --border-color: #ddd;
            --bg-light: #f5f7fa;
            --white: #fff;
            --shadow: 0 2px 10px rgba(0,0,0,0.05);
            --border-radius: 8px;
        }
        
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }
        
        body {
            background-color: var(--bg-light);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: var(--white);
            box-shadow: var(--shadow);
        }
        
        header {
            text-align: center;
            padding: 20px;
            background-color: var(--white);
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }
        
        header h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .header-description {
            margin-bottom: 5px;
        }
        
        /* Botão Sobre - Mais discreto e à direita */
        .about-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: transparent;
            color: var(--light-text);
            border: none;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            width: auto;
            padding: 5px 10px;
            margin: 0;
        }
        
        .about-btn i {
            margin-right: 4px;
            font-size: 14px;
        }
        
        .about-btn:hover {
            color: var(--primary-color);
            background-color: transparent;
        }
        
        /* Modal Sobre */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: var(--white);
            margin: 10% auto;
            padding: 20px;
            border-radius: var(--border-radius);
            max-width: 500px;
            position: relative;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .modal-title {
            color: var(--primary-color);
            margin-bottom: 15px;
            text-align: center;
            font-size: 22px;
            font-weight: 600;
        }
        
        .credits-section {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            text-align: center;
        }
        
        .credits-item {
            margin: 10px 0;
            line-height: 1.5;
        }
        
        .credits-item a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .credits-item a:hover {
            text-decoration: underline;
        }
        
        .close-modal {
            position: absolute;
            top: 10px;
            right: 20px;
            color: var(--light-text);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .close-modal:hover {
            color: var(--primary-color);
        }
        
        /* Tabs Navigation */
        .tabs-nav {
            display: flex;
            list-style: none;
            background-color: var(--white);
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            padding: 0 10px;
            flex-wrap: nowrap; /* Garante que as abas fiquem na mesma linha */
        }
        
        .tabs-nav li {
            flex: 1;
            min-width: 140px;
            text-align: center;
            white-space: nowrap; /* Evita quebra de texto */
        }
        
        .tabs-nav a {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            color: var(--light-text);
            font-weight: 500;
            padding: 15px 10px;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tabs-nav a i {
            font-size: 20px;
            margin-bottom: 8px;
        }
        
        .tabs-nav a.active {
            color: var(--accent-color);
            border-bottom: 3px solid var(--accent-color);
            background-color: var(--white);
        }
        
        .tabs-nav a:hover:not(.active) {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-light);
        }
        
        /* Tab Content */
        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeEffect 0.5s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeEffect {
            from {opacity: 0;}
            to {opacity: 1;}
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: all 0.3s;
            background-color: var(--white);
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        button i {
            margin-right: 8px;
        }
        
        button:hover {
            background-color: var(--primary-dark);
        }
</style>
</head>
<style>
    /* Results section */
    .results {
        margin-top: 30px;
        padding: 20px;
        background-color: var(--primary-light);
        border-radius: var(--border-radius);
        border-left: 4px solid var(--primary-color);
        display: none;
    }
    
    .results h3 {
        color: var(--primary-dark);
        margin-bottom: 15px;
        font-weight: 600;
    }
    
    .result-item {
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .result-label {
        font-weight: 500;
    }
    
    .result-value {
        font-weight: 600;
        color: var(--primary-dark);
    }
    
    .section-title {
        margin-top: 20px;
        margin-bottom: 15px;
        padding-bottom: 8px;
        border-bottom: 1px solid var(--border-color);
        color: var(--primary-dark);
        font-weight: 600;
    }
    
    .indent {
        margin-left: 20px;
    }
    
    /* Info boxes */
    .info-box {
        margin-top: 30px;
        padding: 20px;
        background-color: var(--bg-light);
        border-radius: var(--border-radius);
        border-left: 4px solid var(--primary-color);
    }
    
    .info-box h4 {
        color: var(--primary-color);
        margin-bottom: 15px;
        font-weight: 600;
    }
    
    /* Elementos colapsáveis */
    .medical-notes {
        margin-top: 25px;
        padding: 20px;
        background-color: var(--white);
        border-radius: var(--border-radius);
        border-left: 4px solid var(--primary-color);
        box-shadow: var(--shadow);
    }
    
    .medical-notes h3 {
        color: var(--primary-color);
        margin-bottom: 15px;
        font-weight: 600;
    }
    
    .medical-notes h4 {
        color: var(--text-color);
        margin-top: 20px;
        margin-bottom: 10px;
        font-weight: 600;
    }
    
    pre {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: var(--border-radius);
        overflow-x: auto;
        border-left: 3px solid var(--primary-color);
        font-family: Consolas, Monaco, 'Andale Mono', monospace;
        font-size: 14px;
        line-height: 1.5;
    }
    
    /* Collapsible sections */
    .collapsible {
        background-color: var(--white);
        color: var(--text-color);
        cursor: pointer;
        padding: 15px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 16px;
        font-weight: 600;
        border-radius: var(--border-radius);
        margin-bottom: 10px;
        transition: all 0.3s;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    .collapsible:after {
        content: '\f078';
        font-family: 'Font Awesome 6 Free';
        font-weight: 900;
        font-size: 14px;
        color: var(--light-text);
        transition: all 0.3s;
    }
    
    .collapsible.active-collapse:after {
        transform: rotate(180deg);
    }
    
    .active-collapse, .collapsible:hover {
        background-color: var(--primary-light);
    }
    
    .collapse-content {
        padding: 0;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
        background-color: var(--white);
        border-radius: 0 0 var(--border-radius) var(--border-radius);
        margin-bottom: 10px;
    }
    
    .collapse-content-inner {
        padding: 20px;
    }
    
    /* Tables */
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 15px 0;
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    th {
        background-color: var(--primary-light);
        color: var(--primary-dark);
        padding: 12px;
        text-align: left;
        font-weight: 600;
    }
    
    td {
        padding: 12px;
        border-top: 1px solid var(--border-color);
    }
    
    tr:nth-child(even) {
        background-color: var(--bg-light);
    }
    
    /* Diagrama melhorado para algoritmo - estilo barra horizontal */
    .diagram-container {
        display: flex;
        justify-content: center;
        margin: 30px 0;
    }
    
    .distribution-diagram {
        width: 100%;
        max-width: 800px;
    }
    
    .diagram-row {
        display: flex;
        margin-bottom: 15px;
        align-items: center;
        height: 40px;
    }
    
    .diagram-label {
        width: 120px;
        font-weight: 600;
        text-align: right;
        padding-right: 10px;
        flex-shrink: 0;
    }
    
    .diagram-bar {
        flex-grow: 1;
        height: 100%;
        border-radius: 4px;
        display: flex;
        overflow: hidden;
    }
    
    .bar-section {
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-color);
        font-weight: 600;
        font-size: 14px;
    }
    
    .nph-color {
        background-color: #c0d9ff;
    }
    
    .regular-color {
        background-color: #ffccd5;
    }
    
    .diagram-legend {
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }
    
    .legend-item {
        display: flex;
        align-items: center;
        margin: 0 15px;
    }
    
    .legend-color {
        width: 20px;
        height: 20px;
        border-radius: 4px;
        margin-right: 8px;
    }
    
    /* Novas classes para a via de administração */
    .admin-route-selector {
        margin-bottom: 20px;
        padding: 10px;
        background-color: var(--bg-light);
        border-radius: var(--border-radius);
    }
    
    .route-options {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
    }
    
    .route-option {
        flex: 1;
        min-width: 150px;
        text-align: center;
        padding: 12px;
        background-color: var(--white);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .route-option:hover, .route-option.active {
        background-color: var(--primary-light);
        border-color: var(--primary-color);
    }
    
    .route-option i {
        display: block;
        margin-bottom: 8px;
        font-size: 24px;
        color: var(--primary-color);
    }
    
    .route-description {
        margin-top: 10px;
        font-size: 14px;
        color: var(--light-text);
    }
    
    /* Estilo para horários de aplicação */
    .timing-info {
        margin-top: 15px;
        padding: 10px;
        background-color: #fdf8e3;
        border-left: 4px solid var(--accent-color);
        border-radius: var(--border-radius);
    }
    
    .timing-info h4 {
        color: #8a6d3b;
        margin-bottom: 10px;
    }
    
    .timing-list {
        list-style-type: none;
    }
    
    .timing-list li {
        margin-bottom: 8px;
        display: flex;
        align-items: baseline;
    }
    
    .timing-list li i {
        color: var(--accent-color);
        margin-right: 10px;
        font-size: 12px;
    }
    
    .citation {
        font-size: 12px;
        color: var(--light-text);
        font-style: italic;
        margin-top: 10px;
    }
    
    /* Mobile Responsiveness */
    @media screen and (max-width: 768px) {
        .tabs-nav {
            overflow-x: auto;
        }
        
        .tab-content {
            padding: 20px 15px;
        }
        
        .collapsible {
            padding: 12px;
            font-size: 15px;
        }
        
        header h1 {
            font-size: 24px;
            padding-right: 60px; /* Espaço para o botão Sobre */
        }
        
        header p {
            font-size: 14px;
        }
        
        .diagram-label {
            width: 90px;
            font-size: 12px;
        }
        
        .bar-section {
            font-size: 12px;
        }
    }
    
    @media screen and (max-width: 480px) {
        .tabs-nav a {
            font-size: 14px;
            padding: 10px 5px;
        }
        
        .tabs-nav a i {
            font-size: 16px;
        }
        
        header {
            padding: 15px 10px;
        }
        
        header h1 {
            font-size: 22px;
        }
        
        .tab-content {
            padding: 15px 10px;
        }
        
        .modal-content {
            width: 90%;
            margin: 20% auto;
        }
        
        .about-btn {
            top: 10px;
            right: 10px;
            font-size: 11px;
        }
        
        .about-btn i {
            font-size: 12px;
        }
    }
    
    /* Botão de referências */
    .reference-btn {
        background-color: transparent;
        color: var(--primary-color);
        border: 1px solid var(--primary-color);
        border-radius: var(--border-radius);
        padding: 8px 15px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: auto;
    }

    .reference-btn i {
        margin-right: 8px;
    }

    .reference-btn:hover {
        background-color: var(--primary-light);
        color: var(--primary-dark);
    }

    /* Modal de referências */
    .references-modal {
        max-width: 700px;
        max-height: 80vh;
        overflow-y: auto;
    }

    .references-section {
        margin-bottom: 25px;
        text-align: left;
    }

    .references-section h3 {
        color: var(--primary-dark);
        margin-bottom: 12px;
        padding-bottom: 5px;
        border-bottom: 1px solid var(--border-color);
        font-size: 18px;
    }

    .references-list {
        margin: 0;
        padding-left: 25px;
        font-size: 14px;
        line-height: 1.5;
        color: var(--text-color);
    }

    .references-list li {
        margin-bottom: 10px;
    }
</style>
</head>
<body>
<div class="container">
    <header>
        <h1>Calculadora de Insulina</h1>
        <p class="header-description">Auxílio no cálculo de doses de insulina com base em diferentes métodos</p>
        <button class="about-btn" onclick="openModal()"><i class="fas fa-info-circle"></i> Sobre</button>
    </header>
    
    <!-- Modal Sobre -->
    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 class="modal-title">Sobre a Calculadora de Insulina</h2>
            
            <div class="credits-section">
                <div class="credits-item">
                    <strong>Desenvolvido por:</strong> Eduardo Candeia Gonçalves
                </div>
                <div class="credits-item">
                    <a href="https://github.com/sindlinger" target="_blank">github.com/sindlinger</a>
                </div>
            </div>
            
            <div class="credits-section">
                <div class="credits-item">
                    <strong>Metodologia de cálculo por peso:</strong> Dr. George Ibiapina
                </div>
                <div class="credits-item">
                    Sinceros agradecimentos ao Dr. George Ibiapina pela metodologia de cálculo e orientação científica.
                </div>
            </div>
            
            <div class="credits-section" style="border-bottom: none;">
                <div class="credits-item">
                    <strong>Versão:</strong> 1.1
                </div>
                <div class="credits-item">
                    Esta aplicação é uma ferramenta educativa e não substitui a orientação médica profissional.
                </div>
            </div>
        </div>
    </div>
    <ul class="tabs-nav">
            <li><a href="#peso" class="tab-link active" data-tab="peso"><i class="fas fa-weight"></i> Cálculo por Peso</a></li>
            <li><a href="#regras" class="tab-link" data-tab="regras"><i class="fas fa-calculator"></i> Regras 500/1800</a></li>
            <li><a href="#bolus" class="tab-link" data-tab="bolus"><i class="fas fa-syringe"></i> Cálculo de Bolus</a></li>
            <li><a href="#bomba" class="tab-link" data-tab="bomba"><i class="fas fa-pump-medical"></i> Bomba de Infusão</a></li>
            <li><a href="#medicalInfo" class="tab-link" data-tab="medicalInfo"><i class="fas fa-book-medical"></i> Guia Médico</a></li>
            <li><a href="#algoritmo" class="tab-link" data-tab="algoritmo"><i class="fas fa-chart-line"></i> Algoritmos</a></li>
            <li><a href="#" class="tab-link" onclick="abrirEmergencia()"><i class="fas fa-ambulance"></i> Emergências</a></li>
        </ul>
        
        <!-- Aba 1: Cálculo por Peso -->
        <div id="peso" class="tab-content active">
            <h2>Cálculo baseado no Peso</h2>
            
            <div class="form-group">
                <label for="inputPeso">Peso (kg):</label>
                <input type="number" id="inputPeso" placeholder="Digite o peso em kg" min="0.1" max="300" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="selectFator">Fator (U/kg):</label>
                <select id="selectFator">
                    <option value="0.3">0,3 - Muito sensível</option>
                    <option value="0.5">0,5 - Sensível</option>
                    <option value="0.7" selected>0,7 - Padrão</option>
                    <option value="1.0">1,0 - Resistente</option>
                    <option value="1.5">1,5 - Muito resistente</option>
                    <option value="2.0">2,0 - Extremamente resistente</option>
                    <option value="-1">Personalizado</option>
                </select>
            </div>
            
            <div class="form-group" id="fatorPersonalizadoGroup" style="display: none;">
                <label for="inputFatorPersonalizado">Fator personalizado:</label>
                <input type="number" id="inputFatorPersonalizado" placeholder="Digite o fator personalizado" min="0.1" max="10" step="0.1">
            </div>
            
            <!-- Seleção de via de administração -->
            <div class="admin-route-selector">
                <label>Via de Administração:</label>
                <div class="route-options">
                    <div class="route-option active" id="route-sc" onclick="selectRoute('sc')">
                        <i class="fas fa-syringe"></i>
                        <span>Subcutânea</span>
                    </div>
                    <div class="route-option" id="route-iv" onclick="selectRoute('iv')">
                        <i class="fas fa-pump-medical"></i>
                        <span>Intravenosa</span>
                    </div>
                    <div class="route-option" id="route-im" onclick="selectRoute('im')">
                        <i class="fas fa-prescription-bottle"></i>
                        <span>Intramuscular</span>
                    </div>
                </div>
                <div class="route-description" id="route-description">
                    Via subcutânea: Administração no tecido subcutâneo, geralmente abdômen, coxas ou braços.
                </div>
            </div>
            
            <button onclick="calcularPeso()"><i class="fas fa-calculator"></i> Calcular Doses</button>
            
            <div id="resultadosPeso" class="results">
                <h3>Resultados</h3>
                
                <div class="result-item">
                    <span class="result-label">Dose Total Diária:</span> 
                    <span class="result-value"><span id="doseTotalPeso">--</span> U</span>
                </div>
                
                <h4 class="section-title">Esquema 70/30:</h4>
                
                <div class="result-item">
                    <span class="result-label">Total Intermediária (70%):</span> 
                    <span class="result-value"><span id="doseIntermediaria">--</span> U</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Total Rápida (30%):</span> 
                    <span class="result-value"><span id="doseRapida">--</span> U</span>
                </div>
                
                <h4 class="section-title">Distribuição em 2 doses diárias:</h4>
                <div class="result-item">
                    <span class="result-label">Dose Matinal (2/3):</span> 
                    <span class="result-value"><span id="doseManha">--</span> U</span>
                </div>
                
                <div class="result-item indent">
                    <span class="result-label">Intermediária Manhã (50%):</span> 
                    <span class="result-value"><span id="intermediariaManha">--</span> U</span>
                </div>
                
                <div class="result-item indent">
                    <span class="result-label">Rápida Manhã (50%):</span> 
                    <span class="result-value"><span id="rapidaManha">--</span> U</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Dose Noturna (1/3):</span> 
                    <span class="result-value"><span id="doseNoite">--</span> U</span>
                </div>
                
                <div class="result-item indent">
                    <span class="result-label">Intermediária Noite (50%):</span> 
                    <span class="result-value"><span id="intermediariaNoite">--</span> U</span>
                </div>
                
                <div class="result-item indent">
                    <span class="result-label">Rápida Noite (50%):</span> 
                    <span class="result-value"><span id="rapidaNoite">--</span> U</span>
                </div>
                
                <h4 class="section-title">Esquema Basal-Bolus (50/50):</h4>
                
                <div class="result-item">
                    <span class="result-label">Insulina Basal (50%):</span> 
                    <span class="result-value"><span id="doseBasal">--</span> U</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Insulina Bolus Total (50%):</span> 
                    <span class="result-value"><span id="bolusTotal">--</span> U</span>
                </div>
                
                <div class="result-item indent">
                    <span class="result-label">Bolus Café (40%):</span> 
                    <span class="result-value"><span id="bolusCafe">--</span> U</span>
                </div>
                
                <div class="result-item indent">
                    <span class="result-label">Bolus Almoço (30%):</span> 
                    <span class="result-value"><span id="bolusAlmoco">--</span> U</span>
                </div>
                
                <div class="result-item indent">
                    <span class="result-label">Bolus Jantar (30%):</span> 
                    <span class="result-value"><span id="bolusJantar">--</span> U</span>
                </div>
                
                <!-- Horários de Aplicação -->
                <div class="timing-info">
                    <h4><i class="fas fa-clock"></i> Horários Recomendados de Aplicação:</h4>
                    <ul class="timing-list">
                        <li><i class="fas fa-circle"></i> <strong>Esquema 70/30 (2 doses):</strong></li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Dose matinal: 30 minutos antes do café da manhã (entre 06:00-08:00h)</li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Dose noturna: 30 minutos antes do jantar (entre 18:00-20:00h)</li>
                        <li><i class="fas fa-circle"></i> <strong>Esquema Basal-Bolus:</strong></li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Insulina basal (Glargina/Detemir): Uma vez ao dia, mesmo horário (preferencialmente antes de dormir)</li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Insulina basal (NPH): Duas vezes ao dia (antes do café da manhã e ao deitar)</li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Bolus de insulina rápida: 15-30 minutos antes das refeições</li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Bolus de insulina ultrarrápida: 0-15 minutos antes das refeições</li>
                    </ul>
                    <p class="citation">Fonte: Sociedade Brasileira de Diabetes. Diretrizes da Sociedade Brasileira de Diabetes 2021-2022.</p>
                </div>
            </div>
            
            <div class="info-box">
                <h4>Informações sobre o cálculo:</h4>
                <p><strong>Dose Total Diária:</strong> Geralmente calculada como 0,5 a 1,0 unidades por kg de peso corporal.</p>
                <p><strong>Esquema 70/30:</strong> Divisão em 70% insulina intermediária (NPH) e 30% insulina rápida (Regular).</p>
                <p><strong>Divisão de cada tipo:</strong> No esquema 70/30, tanto a insulina intermediária quanto a rápida são divididas 50/50 entre as doses da manhã e da noite.</p>
                <p><strong>Distribuição diária:</strong> Tipicamente 2/3 da dose total pela manhã e 1/3 à noite.</p>
                <p><strong>Esquema Basal-Bolus:</strong> Alternativa com 50% da dose como insulina basal e 50% como bolus distribuídos nas refeições.</p>
                <p><strong>Vias de administração:</strong></p>
                <ul>
                    <li><strong>Subcutânea (SC):</strong> Via mais comum para uso ambulatorial. Locais: abdômen, coxas, braços e nádegas. Rotação dos locais é essencial.</li>
                    <li><strong>Intravenosa (IV):</strong> Usada em ambiente hospitalar, especialmente em emergências ou no controle de cetoacidose diabética.</li>
                    <li><strong>Intramuscular (IM):</strong> Pode ser usada em situações específicas quando a absorção SC está comprometida.</li>
                </ul>
                <p>Esta calculadora é uma ferramenta educativa. Ajustes individualizados devem ser feitos com base nos diversos fatores clínicos e resposta do paciente.</p>
            </div>
        </div>
        <!-- Aba 2: Regras 500/1800 -->
        <div id="regras" class="tab-content">
            <h2>Regras 500/1800</h2>
            
            <div class="form-group">
                <label for="inputDoseTotal">Dose Total Diária (U):</label>
                <input type="number" id="inputDoseTotal" placeholder="Digite a dose total diária" min="1" max="200" step="0.1">
            </div>
            
            <button onclick="calcularRegras()"><i class="fas fa-calculator"></i> Calcular Fatores</button>
            
            <div id="resultadosRegras" class="results">
                <h3>Resultados</h3>
                
                <h4 class="section-title">Razão Insulina/Carboidrato:</h4>
                
                <div class="result-item">
                    <span class="result-label">Regra dos 500:</span> 
                    <span class="result-value"><span id="razaoIC500">--</span> g de carboidrato por 1U de insulina</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Regra dos 450:</span> 
                    <span class="result-value"><span id="razaoIC450">--</span> g de carboidrato por 1U de insulina</span>
                </div>
                
                <h4 class="section-title">Fator de Sensibilidade à Insulina (FSI):</h4>
                
                <div class="result-item">
                    <span class="result-label">Regra dos 1800:</span> 
                    <span class="result-value"><span id="fsi1800">--</span> mg/dL reduzidos por 1U de insulina</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Regra dos 1500:</span> 
                    <span class="result-value"><span id="fsi1500">--</span> mg/dL reduzidos por 1U de insulina</span>
                </div>
            </div>
            
            <div class="info-box">
                <h4>Explicação:</h4>
                <p><strong>Regra dos 500 (Razão Insulina/Carboidrato):</strong> Determina quantos gramas de carboidrato são cobertos por 1 unidade de insulina.</p>
                <p><strong>Fórmula:</strong> 500 ÷ Dose Total Diária = g de carboidrato por 1U de insulina</p>
                
                <p><strong>Base fisiológica:</strong> A quantidade de carboidratos metabolizada por unidade de insulina está inversamente relacionada à dose total diária. Pacientes que precisam de mais insulina diária (mais resistentes à insulina) têm uma razão menor, onde cada unidade de insulina cobre menos carboidratos.</p>
                
                <p><strong>Regra dos 1800 (Fator de Sensibilidade):</strong> Determina quantos mg/dL a glicemia será reduzida por 1 unidade de insulina.</p>
                <p><strong>Fórmula:</strong> 1800 ÷ Dose Total Diária = mg/dL reduzidos por 1U de insulina</p>
                
                <p><strong>Base fisiológica:</strong> Quantifica a potência da insulina em diferentes indivíduos. Quanto maior a dose total diária, menor o impacto de cada unidade na glicemia.</p>
                <p><strong>Aplicação prática:</strong>
                    <br>• Bolus alimentar = Carboidratos (g) ÷ Razão IC
                    <br>• Bolus correção = (Glicemia atual - Glicemia alvo) ÷ FSI</p>
                    
                <p><strong>Observação:</strong> Estas regras são aproximações e devem ser ajustadas com base na resposta glicêmica individual de cada paciente.</p>
                
                <div class="timing-info">
                    <h4><i class="fas fa-clock"></i> Aplicação Prática Conforme Horário:</h4>
                    <ul class="timing-list">
                        <li><i class="fas fa-circle"></i> <strong>Uso da Razão IC:</strong></li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Calcular bolus alimentar antes das refeições</li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Ajustar a razão conforme o período do dia (alguns pacientes têm maior resistência pela manhã)</li>
                        <li><i class="fas fa-circle"></i> <strong>Uso do FSI:</strong></li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Corrigir hiperglicemias intercorrentes</li>
                        <li class="indent"><i class="fas fa-angle-right"></i> Evitar correções muito próximas (respeitar o tempo de ação da insulina, mínimo 3-4h)</li>
                    </ul>
                    <p class="citation">Fonte: Davidson, P. C., et al. (2008). Analysis of guidelines for basal-bolus insulin dosing. Endocrine Practice.</p>
                </div>
            </div>
        </div>
        <!-- Aba 3: Cálculo de Bolus -->
        <div id="bolus" class="tab-content">
            <h2>Cálculo de Bolus</h2>
            
            <div class="form-group">
                <label for="inputGlicemiaAtual">Glicemia Atual (mg/dL):</label>
                <input type="number" id="inputGlicemiaAtual" placeholder="Digite a glicemia atual" min="40" max="600">
            </div>
            
            <div class="form-group">
                <label for="inputGlicemiaAlvo">Glicemia Alvo (mg/dL):</label>
                <input type="number" id="inputGlicemiaAlvo" placeholder="Digite a glicemia alvo" min="70" max="180" value="100">
            </div>
            
            <div class="form-group">
                <label for="inputCarboidratos">Carboidratos a serem consumidos (g):</label>
                <input type="number" id="inputCarboidratos" placeholder="Digite a quantidade de carboidratos" min="0" max="300" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="inputRazaoIC">Razão Insulina/Carboidrato:</label>
                <input type="number" id="inputRazaoIC" placeholder="g de carboidrato por 1U de insulina" min="1" max="100" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="inputFSI">Fator de Sensibilidade (FSI):</label>
                <input type="number" id="inputFSI" placeholder="mg/dL reduzidos por 1U de insulina" min="1" max="100" step="0.1">
            </div>
            
            <!-- Seleção de insulina para bolus -->
            <div class="admin-route-selector">
                <label>Tipo de Insulina para Bolus:</label>
                <div class="route-options">
                    <div class="route-option active" id="insulin-regular" onclick="selectInsulinType('regular')">
                        <i class="fas fa-vial"></i>
                        <span>Regular</span>
                    </div>
                    <div class="route-option" id="insulin-rapid" onclick="selectInsulinType('rapid')">
                        <i class="fas fa-bolt"></i>
                        <span>Ultrarrápida</span>
                    </div>
                </div>
                <div class="route-description" id="insulin-description">
                    Insulina Regular: Início em 30min, pico em 2-3h, duração 5-8h. Aplicar 30min antes das refeições.
                </div>
            </div>
            
            <button onclick="calcularBolus()"><i class="fas fa-syringe"></i> Calcular Bolus</button>
            
            <div id="resultadosBolus" class="results">
                <h3>Resultados do Cálculo de Bolus</h3>
                
                <div class="result-item">
                    <span class="result-label">Diferença de Glicemia (atual - alvo):</span> 
                    <span class="result-value"><span id="diferencaGlicemia">--</span> mg/dL</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Bolus de Correção:</span> 
                    <span class="result-value"><span id="bolusCorrecao">--</span> U</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Bolus Alimentar:</span> 
                    <span class="result-value"><span id="bolusAlimentar">--</span> U</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Bolus Total:</span> 
                    <span class="result-value"><span id="bolusTotalFinal">--</span> U</span>
                </div>
                
                <!-- Timing info for bolus administration -->
                <div class="timing-info">
                    <h4><i class="fas fa-clock"></i> Horário de Aplicação:</h4>
                    <div id="bolus-timing-info">
                        <strong>Insulina Regular:</strong> 
                        <ul class="timing-list">
                            <li><i class="fas fa-angle-right"></i> Aplicar 30 minutos antes da refeição</li>
                            <li><i class="fas fa-angle-right"></i> Esperar absorção antes de se alimentar para evitar picos glicêmicos</li>
                        </ul>
                    </div>
                    <p class="citation">Fonte: American Diabetes Association. (2022). Standards of Medical Care in Diabetes. Diabetes Care.</p>
                </div>
            </div>
            
            <div class="info-box">
                <h4>Como o cálculo é feito:</h4>
                <p><strong>Bolus de Correção:</strong> Corrige a glicemia elevada</p>
                <p><em>Fórmula:</em> (Glicemia Atual - Glicemia Alvo) ÷ FSI = Unidades de insulina</p>
                <p><strong>Bolus Alimentar:</strong> Cobre os carboidratos a serem consumidos</p>
                <p><em>Fórmula:</em> Quantidade de Carboidratos ÷ Razão IC = Unidades de insulina</p>
                <p><strong>Bolus Total:</strong> Bolus de Correção + Bolus Alimentar</p>
                <p><strong>Observação:</strong> Se a glicemia estiver abaixo do alvo, considere reduzir o bolus alimentar ou consumir carboidratos extras.</p>
                
                <h4>Diferenças entre insulinas:</h4>
                <table>
                    <tr>
                        <th>Tipo</th>
                        <th>Início de ação</th>
                        <th>Pico</th>
                        <th>Duração</th>
                        <th>Tempo antes da refeição</th>
                    </tr>
                    <tr>
                        <td>Regular</td>
                        <td>30 minutos</td>
                        <td>2-3 horas</td>
                        <td>5-8 horas</td>
                        <td>30 minutos</td>
                    </tr>
                    <tr>
                        <td>Ultrarrápida (Lispro, Aspart)</td>
                        <td>10-15 minutos</td>
                        <td>1-2 horas</td>
                        <td>3-5 horas</td>
                        <td>0-15 minutos</td>
                    </tr>
                </table>
            </div>
        </div>
        <!-- Aba 4: Bomba de Infusão (Nova) -->
        <div id="bomba" class="tab-content">
            <h2>Cálculo para Bomba de Infusão</h2>
            
            <div class="form-group">
                <label for="inputPesoBomba">Peso (kg):</label>
                <input type="number" id="inputPesoBomba" placeholder="Digite o peso em kg" min="0.1" max="300" step="0.1">
            </div>
            
            <div class="form-group">
                <label for="selectDoseBomba">Dosagem (U/kg/hora):</label>
                <select id="selectDoseBomba">
                    <option value="0.02">0,02 - Baixa intensidade</option>
                    <option value="0.05" selected>0,05 - Intensidade padrão</option>
                    <option value="0.1">0,10 - Alta intensidade</option>
                    <option value="-1">Personalizada</option>
                </select>
            </div>
            
            <div class="form-group" id="doseBombaPersonalizadaGroup" style="display: none;">
                <label for="inputDoseBombaPersonalizada">Dosagem personalizada (U/kg/hora):</label>
                <input type="number" id="inputDoseBombaPersonalizada" placeholder="Digite a dosagem" min="0.01" max="1" step="0.01">
            </div>
            
            <div class="form-group">
                <label for="selectConcentracao">Concentração da Solução:</label>
                <select id="selectConcentracao">
                    <option value="1">1 U/mL (diluição 1:1)</option>
                    <option value="0.1">0,1 U/mL (diluição 1:10)</option>
                    <option value="0.01">0,01 U/mL (diluição 1:100)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="selectInfusor">Tipo de Infusor:</label>
                <select id="selectInfusor">
                    <option value="seringa">Bomba de Seringa</option>
                    <option value="volumetrica">Bomba Volumétrica</option>
                </select>
            </div>
            
            <button onclick="calcularBomba()"><i class="fas fa-pump-medical"></i> Calcular Dose</button>
            
            <div id="resultadosBomba" class="results">
                <h3>Resultados para Infusão Contínua</h3>
                
                <div class="result-item">
                    <span class="result-label">Dose horária total:</span> 
                    <span class="result-value"><span id="doseHorariaBomba">--</span> U/h</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Volume a infundir:</span> 
                    <span class="result-value"><span id="volumeInfusao">--</span> mL/h</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Velocidade de infusão:</span> 
                    <span class="result-value"><span id="velocidadeInfusao">--</span> mL/h</span>
                </div>
                
                <h4 class="section-title">Dose em 24 horas:</h4>
                
                <div class="result-item">
                    <span class="result-label">Dose total em 24h:</span> 
                    <span class="result-value"><span id="doseDia">--</span> U</span>
                </div>
                
                <div class="result-item">
                    <span class="result-label">Volume total em 24h:</span> 
                    <span class="result-value"><span id="volumeDia">--</span> mL</span>
                </div>
                
                <div class="timing-info">
                    <h4><i class="fas fa-check-circle"></i> Monitoramento:</h4>
                    <ul class="timing-list">
                        <li><i class="fas fa-angle-right"></i> <strong>Frequência de Verificação de Glicemia:</strong> A cada 1-2 horas até estabilização, depois a cada 4 horas</li>
                        <li><i class="fas fa-angle-right"></i> <strong>Ajuste de Dose:</strong> Incrementos/decrementos de 0,01 U/kg/h conforme necessário</li>
                        <li><i class="fas fa-angle-right"></i> <strong>Objetivo Glicêmico:</strong> Manter glicemia entre 140-180 mg/dL para pacientes críticos</li>
                    </ul>
                    <p class="citation">Fonte: American Diabetes Association. (2022). Standards of Medical Care in Diabetes. Diabetes Care, 45(Supplement 1).</p>
                </div>
            </div>
            
            <div class="info-box">
                <h4>Informações sobre Bomba de Infusão:</h4>
                <p><strong>Indicações para infusão IV de insulina:</strong></p>
                <ul>
                    <li>Pacientes em estado crítico</li>
                    <li>Cetoacidose diabética</li>
                    <li>Estado hiperglicêmico hiperosmolar</li>
                    <li>Perioperatório de cirurgias de grande porte</li>
                    <li>Nutrição parenteral total</li>
                    <li>Uso de corticosteroides em altas doses</li>
                </ul>
                
                <p><strong>Diluição da solução:</strong></p>
                <ul>
                    <li><strong>1:1 (1 U/mL)</strong> - Padrão para a maioria dos pacientes adultos</li>
                    <li><strong>1:10 (0,1 U/mL)</strong> - Para pacientes muito sensíveis ou com necessidade de infusão precisa</li>
                    <li><strong>1:100 (0,01 U/mL)</strong> - Para pacientes pediátricos ou necessidades de doses mínimas</li>
                </ul>
                
                <p><strong>Como preparar:</strong></p>
                <ul>
                    <li><strong>1:1</strong> - 100 unidades (1 mL) de insulina regular em 99 mL de solução salina = 100 mL total (1 U/mL)</li>
                    <li><strong>1:10</strong> - 10 unidades (0,1 mL) de insulina regular em 99,9 mL de solução salina = 100 mL total (0,1 U/mL)</li>
                    <li><strong>1:100</strong> - 1 unidade (0,01 mL) de insulina regular em 99,99 mL de solução salina = 100 mL total (0,01 U/mL)</li>
                </ul>
                
                <p><strong>Observações importantes:</strong></p>
                <ul>
                    <li>Usar apenas insulina regular humana para infusão intravenosa</li>
                    <li>Trocar o sistema e a solução a cada 24 horas</li>
                    <li>Avaliar a necessidade de reposição de potássio</li>
                    <li>Administrar dextrose quando a glicemia atinge 250 mg/dL em cetoacidose e 300 mg/dL em hiperosmolar</li>
                </ul>
                
                <p><strong>Transição da infusão IV para SC:</strong></p>
                <ul>
                    <li>Calcular a dose total de insulina nas últimas 6 horas</li>
                    <li>Multiplicar por 4 para obter a dose diária estimada</li>
                    <li>Dividir 50% para basal e 50% para bolus</li>
                    <li>Iniciar insulina SC 1-2 horas antes de suspender a infusão</li>
                </ul>
                
                <p class="citation">Referências: Sociedade Brasileira de Diabetes. (2022). Diretrizes da Sociedade Brasileira de Diabetes 2021-2022.</p>
            </div>
        </div>
        <!-- Aba 5: Guia Médico -->
        <div id="medicalInfo" class="tab-content">
            <h2>Guia Médico - Insulinoterapia</h2>
            
            <button class="collapsible">Tipos de Insulina e Farmacocinética</button>
            <div class="collapse-content">
                <div class="collapse-content-inner">
                    <table>
                        <tr>
                            <th>Tipo</th>
                            <th>Início de ação</th>
                            <th>Pico</th>
                            <th>Duração</th>
                            <th>Via de Administração</th>
                        </tr>
                        <tr>
                            <td>Ultra-rápida (Lispro, Aspart, Glulisina)</td>
                            <td>10-15 min</td>
                            <td>1-2h</td>
                            <td>3-5h</td>
                            <td>SC, IV (em ambiente hospitalar)</td>
                        </tr>
                        <tr>
                            <td>Rápida (Regular)</td>
                            <td>30 min</td>
                            <td>2-3h</td>
                            <td>5-8h</td>
                            <td>SC, IV, IM</td>
                        </tr>
                        <tr>
                            <td>Intermediária (NPH)</td>
                            <td>2-4h</td>
                            <td>4-10h</td>
                            <td>10-16h</td>
                            <td>SC</td>
                        </tr>
                        <tr>
                            <td>Longa (Glargina)</td>
                            <td>2-4h</td>
                            <td>Sem pico</td>
                            <td>20-24h</td>
                            <td>SC</td>
                        </tr>
                        <tr>
                            <td>Ultra-longa (Degludeca)</td>
                            <td>1-2h</td>
                            <td>Sem pico</td>
                            <td>>42h</td>
                            <td>SC</td>
                        </tr>
                    </table>
                    <p><strong>Observação:</strong> A insulina NPH apresenta grande variabilidade entre pacientes e mesmo no mesmo paciente em dias diferentes.</p>
                    <p><strong>Vias de Administração:</strong></p>
                    <ul>
                        <li><strong>SC (Subcutânea):</strong> Via mais comum para uso ambulatorial. Absorção mais lenta e prolongada.</li>
                        <li><strong>IV (Intravenosa):</strong> Início de ação imediato. Usada em emergências e ambiente hospitalar.</li>
                        <li><strong>IM (Intramuscular):</strong> Absorção mais rápida que SC, mas menos previsível. Pode ser útil em emergências.</li>
                    </ul>
                    <p class="citation">Fonte: Sociedade Brasileira de Diabetes. (2022). Diretrizes da Sociedade Brasileira de Diabetes 2021-2022.</p>
                </div>
            </div>
            
            <button class="collapsible">Esquemas de Tratamento</button>
            <div class="collapse-content">
                <div class="collapse-content-inner">
                    <h4>1. Esquema Convencional (70/30 ou 2 doses)</h4>
                    <p>Mais simples, menos flexível, geralmente 2 injeções por dia (manhã e noite).</p>
                    <ul>
                        <li><strong>2/3 da dose pela manhã:</strong> 
                            <ul>
                                <li>50% Intermediária (NPH) + 50% Rápida (Regular) antes do café</li>
                                <li><strong>Horário:</strong> 30 minutos antes do café da manhã (06:00-08:00h)</li>
                            </ul>
                        </li>
                        <li><strong>1/3 da dose à noite:</strong> 
                            <ul>
                                <li>50% Intermediária (NPH) + 50% Rápida (Regular) antes do jantar</li>
                                <li><strong>Horário:</strong> 30 minutos antes do jantar (18:00-20:00h)</li>
                            </ul>
                        </li>
                    </ul>
                    <p><strong>Indicações:</strong> Pacientes com rotina regular, idosos, dificuldade de adesão a esquemas complexos.</p>
                    
                    <h4>2. Esquema Basal-Bolus (múltiplas doses)</h4>
                    <p>Mais fisiológico, flexível, geralmente 4 injeções por dia.</p>
                    <ul>
                        <li><strong>Basal (50% da dose total):</strong> 
                            <ul>
                                <li>Insulina de ação longa 1x/dia (Glargina, Degludeca) ou NPH 2x/dia</li>
                                <li><strong>Horário (Glargina/Degludeca):</strong> Mesmo horário todos os dias, preferencialmente antes de dormir</li>
                                <li><strong>Horário (NPH):</strong> Antes do café da manhã e ao deitar</li>
                            </ul>
                        </li>
                        <li><strong>Bolus (50% da dose total):</strong> Insulina de ação rápida antes das refeições
                            <ul>
                                <li>40% no café da manhã</li>
                                <li>30% no almoço</li>
                                <li>30% no jantar</li>
                                <li><strong>Horário (Regular):</strong> 30 minutos antes das refeições</li>
                                <li><strong>Horário (Ultrarrápida):</strong> 0-15 minutos antes das refeições</li>
                            </ul>
                        </li>
                    </ul>
                    <p><strong>Indicações:</strong> DM1, gestantes, rotina variável, melhor controle glicêmico.</p>
                    
                    <h4>3. Esquema Misto Adaptado</h4>
                    <p>Flexibilidade intermediária.</p>
                    <ul>
                        <li><strong>Basal:</strong> 
                            <ul>
                                <li>Insulina de ação longa 1x/dia</li>
                                <li><strong>Horário:</strong> Antes de dormir (21:00-23:00h)</li>
                            </ul>
                        </li>
                        <li><strong>Correções:</strong> 
                            <ul>
                                <li>Insulina de ação rápida de acordo com as glicemias capilares</li>
                                <li><strong>Horário:</strong> Conforme necessidade, respeitando o tempo de ação da insulina anterior</li>
                            </ul>
                        </li>
                    </ul>
                    <p><strong>Indicações:</strong> Pacientes com dificuldade para múltiplas doses mas que precisam de melhor controle.</p>
                    
                    <p class="citation">Fonte: Sociedade Brasileira de Diabetes. (2022). Diretrizes da Sociedade Brasileira de Diabetes 2021-2022.</p>
                </div>
            </div>
            
            <button class="collapsible">Ajustes de Dose e Monitoramento</button>
            <div class="collapse-content">
                <div class="collapse-content-inner">
                    <h4>Monitoramento ideal para ajuste:</h4>
                    <ul>
                        <li>Glicemia de jejum (ajusta basal noturna)</li>
                        <li>Glicemia pré-almoço (ajusta basal matinal)</li>
                        <li>Glicemia pré-jantar (ajusta basal vespertina)</li>
                        <li>Glicemia 2h pós-refeições (ajusta bolus)</li>
                    </ul>
                    
                    <h4>Regras para ajuste de dose:</h4>
                    <ul>
                        <li><strong>Ajustes lentos e pequenos:</strong> 10-20% da dose a cada 2-3 dias</li>
                        <li><strong>Hipoglicemias:</strong> Reduzir dose da insulina correspondente ao período em 20%</li>
                        <li><strong>Hiperglicemia persistente:</strong> Aumentar insulina correspondente ao período em 10-20%</li>
                        <li><strong>Fenômeno do alvorecer:</strong> Hiperglicemia matinal por aumento de hormônios contrarreguladores; pode requerer ajuste na NPH noturna ou Glargina</li>
                    </ul>
                    
                    <h4>Alvo glicêmico:</h4>
                    <ul>
                        <li><strong>Jovens saudáveis:</strong> 80-130 mg/dL (jejum) e &lt;180 mg/dL (pós-prandial)</li>
                        <li><strong>Idosos ou com comorbidades:</strong> 100-180 mg/dL (jejum) e &lt;200 mg/dL (pós-prandial)</li>
                        <li><strong>Gestantes:</strong> &lt;95 mg/dL (jejum) e &lt;120 mg/dL (pós-prandial)</li>
                    </ul>
                    
                    <h4>Horários recomendados para monitoramento:</h4>
                    <ul>
                        <li><strong>Glicemia de jejum:</strong> Ao acordar, antes do café da manhã (06:00-08:00h)</li>
                        <li><strong>Glicemia pré-prandial:</strong> Antes das principais refeições</li>
                        <li><strong>Glicemia pós-prandial:</strong> 2 horas após o início das refeições</li>
                        <li><strong>Glicemia ao deitar:</strong> Antes de dormir (22:00-23:00h)</li>
                        <li><strong>Glicemia da madrugada:</strong> Entre 02:00-04:00h (quando suspeita de hipoglicemia noturna)</li>
                    </ul>
                    
                    <p class="citation">Fonte: American Diabetes Association. (2022). Standards of Medical Care in Diabetes. Diabetes Care, 45(Supplement 1).</p>
                </div>
            </div>
            
            <button class="collapsible">Complicações e Manejo</button>
            <div class="collapse-content">
                <div class="collapse-content-inner">
                    <h4>Hipoglicemia:</h4>
                    <p><strong>Definição:</strong> Glicemia &lt;70 mg/dL</p>
                    <ul>
                        <li><strong>Tratamento:</strong> 
                            <ul>
                                <li>Paciente consciente: 15g de carboidrato rápido (3 colheres de açúcar, 150ml de suco)</li>
                                <li>Paciente inconsciente: Glucagon IM/SC ou Glicose 50% EV</li>
                            </ul>
                        </li>
                        <li><strong>Prevenção:</strong> 
                            <ul>
                                <li>Monitoramento frequente</li>
                                <li>Ajuste de dose (reduzir em 20% se hipoglicemias frequentes)</li>
                                <li>Considerar lanches intermediários</li>
                            </ul>
                        </li>
                    </ul>
                    
                    <h4>Lipodistrofia:</h4>
                    <ul>
                        <li>Alteração do tecido subcutâneo por injeções repetidas no mesmo local</li>
                        <li><strong>Impacto:</strong> Absorção errática de insulina</li>
                        <li><strong>Prevenção:</strong> Rodízio dos locais de aplicação</li>
                    </ul>
                    
                    <h4>Efeito Somogyi:</h4>
                    <p>Hiperglicemia matinal paradoxal após hipoglicemia noturna (rebote hiperglicêmico).</p>
                    <p><strong>Manejo:</strong> Reduzir dose de insulina noturna.</p>
                    
                    <h4>Locais de aplicação e suas características:</h4>
                    <ul>
                        <li><strong>Abdômen:</strong> Absorção mais rápida e consistente. Preferencial para doses antes das refeições.</li>
                        <li><strong>Coxas:</strong> Absorção mais lenta. Pode ser útil para insulina basal noturna.</li>
                        <li><strong>Braços (região posterior):</strong> Absorção intermediária. Bom para insulina de ação intermediária.</li>
                        <li><strong>Nádegas:</strong> Absorção mais lenta. Útil para insulina basal.</li>
                    </ul>
                    
                    <p><strong>Esquema de Rodízio:</strong> Manter o mesmo local para o mesmo horário do dia, mudando apenas alguns centímetros a cada aplicação. Alternar para outro local após 1-2 semanas.</p>
                    
                    <p class="citation">Fonte: Sociedade Brasileira de Diabetes. (2022). Diretrizes da Sociedade Brasileira de Diabetes 2021-2022.</p>
                </div>
            </div>
            
            <button class="collapsible">Situações Especiais</button>
            <div class="collapse-content">
                <div class="collapse-content-inner">
                    <h4>Paciente hospitalizado:</h4>
                    <ul>
                        <li><strong>Não crítico:</strong> Esquema basal-bolus-correção. Evitar sliding scale isolado</li>
                        <li><strong>Crítico:</strong> Infusão EV contínua, alvo 140-180 mg/dL</li>
                        <li><strong>Jejum para procedimentos:</strong> 50-80% da basal, suspender bolus</li>
                    </ul>
                    
                    <h4>Paciente com Doença Renal Crônica:</h4>
                    <ul>
                        <li>Maior risco de hipoglicemia por redução da degradação renal de insulina</li>
                        <li>Reduzir doses em 25-50% conforme TFG</li>
                        <li>Preferir insulinas com metabolização hepática (Detemir)</li>
                    </ul>
                    
                    <h4>Paciente corticodependente:</h4>
                    <ul>
                        <li>Aumento importante da resistência à insulina</li>
                        <li>Pode requerer 30-40% a mais de insulina</li>
                        <li>Maior necessidade de bolus à tarde se corticoide matinal</li>
                        <li><strong>Horário:</strong> Ajustar o horário do bolus para coincidir com o pico do corticoide</li>
                    </ul>
                    
                    <h4>Gravidez:</h4>
                    <ul>
                        <li>Controle rigoroso: jejum <95 mg/dL, 1h pós-prandial <140 mg/dL, 2h <120 mg/dL</li>
                        <li>Esquema basal-bolus preferencial</li>
                        <li>Necessidade crescente de insulina ao longo da gestação</li>
                        <li><strong>Monitoramento:</strong> Pelo menos 6 vezes ao dia, incluindo madrugada</li>
                    </ul>
                    
                    <p class="citation">Fonte: American Diabetes Association. (2022). Standards of Medical Care in Diabetes. Diabetes Care, 45(Supplement 1).</p>
                </div>
            </div>
            
            <button class="collapsible">Pearls para Prescrição e Acompanhamento</button>
            <div class="collapse-content">
                <div class="collapse-content-inner">
                    <ul>
                        <li>Informe ao paciente que em média são necessários 3 dias para que um ajuste de dose basal se estabilize e mostre resultados;</li>
                        <li>Considerar o momento alimentar em relação ao pico da insulina: Regular deve ser aplicada 30 min antes das refeições;</li>
                        <li>Pacientes com neuropatia autonômica podem não perceber sintomas adrenérgicos de hipoglicemia - monitoramento mais frequente;</li>
                        <li>Uma simples regra prática: para cada 30 mg/dL acima do alvo, adicione 2U de insulina de correção;</li>
                        <li>Ao iniciar corticoterapia, aumente a dose de insulina em 20% e monitore para ajustes adicionais;</li>
                        <li>O efeito cumulativo da insulina NPH pode causar hipoglicemias tardias - atenção aos esquemas BID;</li>
                        <li>Exercícios podem aumentar a sensibilidade à insulina por até 48h - oriente redução de dose para atividades não rotineiras;</li>
                        <li>Infecções e estresse agudo podem aumentar a necessidade de insulina em 20-50%;</li>
                        <li>Bolus prandial: aplique antes das refeições. Bolus de correção: pode ser aplicado a qualquer momento;</li>
                        <li>Na ausência de automonitoramento, prefira esquemas menos intensivos e mais previsíveis.</li>
                    </ul>
                    
                    <h4>Horários específicos a observar:</h4>
                    <ul>
                        <li><strong>Período pré-café da manhã (6-8h):</strong> Avalia eficácia da insulina basal noturna</li>
                        <li><strong>Período pré-almoço (11-12h):</strong> Avalia eficácia do bolus matinal</li>
                        <li><strong>Período pré-jantar (18-19h):</strong> Avalia eficácia da insulina basal matinal (se NPH em duas doses)</li>
                        <li><strong>Período ao deitar (22-23h):</strong> Avalia eficácia do bolus do jantar</li>
                        <li><strong>Período da madrugada (2-3h):</strong> Detecta hipoglicemias noturnas assintomáticas</li>
                    </ul>
                    
                    <p class="citation">Fonte: Sociedade Brasileira de Diabetes. (2022). Diretrizes da Sociedade Brasileira de Diabetes 2021-2022.</p>
                </div>
            </div>
        </div>
        <!-- Aba 6: Algoritmos -->
        <div id="algoritmo" class="tab-content">
            <h2>Algoritmos e Metodologia de Cálculo</h2>
            <p>Esta seção detalha os algoritmos e fórmulas utilizados na calculadora para revisão técnica e validação.</p>
            
            <div class="medical-notes">
                <h3>1. Cálculo Baseado no Peso</h3>
                <h4>Fórmula Base:</h4>
                <pre>
Dose Total Diária (DTD) = Peso (kg) × Fator (U/kg)

Onde Fator pode ser:
- 0,3 U/kg: Pacientes muito sensíveis à insulina
- 0,5 U/kg: Pacientes sensíveis
- 0,7 U/kg: Sensibilidade padrão
- 1,0 U/kg: Pacientes resistentes
- 1,5 U/kg: Pacientes muito resistentes
- 2,0 U/kg: Pacientes extremamente resistentes
</pre>

                <h4>Esquema 70/30 (Divisão Corrigida):</h4>
                <pre>
Intermediária total = DTD × 0,7
Rápida total = DTD × 0,3

Divisão de cada tipo:
- 50% Intermediária para manhã, 50% para noite
- 50% Rápida para manhã, 50% para noite
</pre>

                <h4>Distribuição em 2 Doses Diárias:</h4>
                <pre>
Dose Matinal = DTD × (2/3)
Intermediária Manhã = Dose Matinal × 0,7 × 0,5
Rápida Manhã = Dose Matinal × 0,3 × 0,5

Dose Noturna = DTD × (1/3)
Intermediária Noite = Dose Noturna × 0,7 × 0,5
Rápida Noite = Dose Noturna × 0,3 × 0,5
</pre>

                <h4>Esquema Basal-Bolus Alternativo:</h4>
                <pre>
Insulina Basal = DTD × 0,5
Insulina Bolus Total = DTD × 0,5
Bolus Café = Insulina Bolus Total × 0,4
Bolus Almoço = Insulina Bolus Total × 0,3
Bolus Jantar = Insulina Bolus Total × 0,3
</pre>

                <h3>2. Regras 500/1800</h3>
                <h4>Razão Insulina/Carboidrato:</h4>
                <pre>
Regra dos 500:
Razão IC = 500 ÷ DTD
(g de carboidrato cobertos por 1U de insulina)

Variação (para pacientes mais sensíveis):
Razão IC = 450 ÷ DTD
</pre>

                <h4>Fator de Sensibilidade à Insulina (FSI):</h4>
                <pre>
Regra dos 1800:
FSI = 1800 ÷ DTD
(mg/dL reduzidos por 1U de insulina)

Variação (para pacientes mais sensíveis):
FSI = 1500 ÷ DTD
</pre>

                <h3>3. Cálculo de Bolus</h3>
                <h4>Bolus de Correção:</h4>
                <pre>
Diferença Glicêmica = max(0, Glicemia Atual - Glicemia Alvo)
Bolus de Correção = Diferença Glicêmica ÷ FSI

Onde:
- Glicemia Atual: valor atual da glicemia em mg/dL
- Glicemia Alvo: valor alvo da glicemia em mg/dL (geralmente 100-120 mg/dL)
- FSI: Fator de Sensibilidade à Insulina (mg/dL por 1U)
</pre>

                <h4>Bolus Alimentar:</h4>
                <pre>
Bolus Alimentar = Quantidade de Carboidratos (g) ÷ Razão IC

Onde:
- Razão IC: gramas de carboidrato cobertas por 1U de insulina
</pre>

                <h4>Bolus Total:</h4>
                <pre>
Bolus Total = Bolus de Correção + Bolus Alimentar
</pre>

                <h3>4. Cálculo para Bomba de Infusão</h3>
                <h4>Fórmula para Infusão Contínua:</h4>
                <pre>
Dose Horária (U/h) = Peso (kg) × Dosagem (U/kg/h)
Volume a Infundir (mL/h) = Dose Horária ÷ Concentração (U/mL)
Dose em 24h (U) = Dose Horária × 24
Volume em 24h (mL) = Volume a Infundir × 24
</pre>
            </div>
            
            <div class="medical-notes" style="margin-top: 20px;">
                <h3>Representação do Esquema de Distribuição de Insulina</h3>
                
                <!-- Diagrama melhorado em barras horizontais -->
                <div class="diagram-container">
                    <div class="distribution-diagram">
                        <h4 style="text-align: center; margin-bottom: 20px;">Esquema de Distribuição da Dose Total (70/30)</h4>
                        
                        <!-- Dose Total -->
                        <div class="diagram-row">
                            <div class="diagram-label">Dose Total:</div>
                            <div class="diagram-bar">
                                <div class="bar-section nph-color" style="width:70%;">Intermediária 70%</div>
                                <div class="bar-section regular-color" style="width:30%;">Rápida 30%</div>
                            </div>
                        </div>
                        
                        <!-- Dose Matinal -->
                        <div class="diagram-row">
                            <div class="diagram-label">Dose Matinal (2/3):</div>
                            <div class="diagram-bar">
                                <div class="bar-section nph-color" style="width:46.7%;">Intermediária (70% × 2/3)</div>
                                <div class="bar-section regular-color" style="width:20%;">Rápida (30% × 2/3)</div>
                            </div>
                        </div>
                        
                        <!-- Dose Noturna -->
                        <div class="diagram-row">
                            <div class="diagram-label">Dose Noturna (1/3):</div>
                            <div class="diagram-bar">
                                <div class="bar-section nph-color" style="width:23.3%;">Intermediária (70% × 1/3)</div>
                                <div class="bar-section regular-color" style="width:10%;">Rápida (30% × 1/3)</div>
                            </div>
                        </div>
                        
                        <!-- Esquema Basal-Bolus -->
                        <div style="margin-top: 30px;">
                            <h4 style="text-align: center; margin-bottom: 20px;">Esquema Basal-Bolus (50/50)</h4>
                            
                            <!-- Dose Total -->
                            <div class="diagram-row">
                                <div class="diagram-label">Dose Total:</div>
                                <div class="diagram-bar">
                                    <div class="bar-section nph-color" style="width:50%;">Basal 50%</div>
                                    <div class="bar-section regular-color" style="width:50%;">Bolus 50%</div>
                                </div>
                            </div>
                            
                            <!-- Distribuição Bolus -->
                            <div class="diagram-row">
                                <div class="diagram-label">Distribuição Bolus:</div>
                                <div class="diagram-bar">
                                    <div class="bar-section regular-color" style="width:40%; background-color: #ffa8b4;">Café 40%</div>
                                    <div class="bar-section regular-color" style="width:30%; background-color: #ffbcc5;">Almoço 30%</div>
                                    <div class="bar-section regular-color" style="width:30%; background-color: #ffd0d6;">Jantar 30%</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Legenda -->
                        <div class="diagram-legend">
                            <div class="legend-item">
                                <div class="legend-color nph-color"></div>
                                <span>Intermediária/Basal</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color regular-color"></div>
                                <span>Rápida/Bolus</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h4>Explicação do Diagrama:</h4>
                <p>O diagrama representa visualmente a distribuição da dose total calculada:</p>
                <ol>
                    <li>A dose total é dividida em:
                        <ul>
                            <li>70% para Intermediária e 30% para Rápida (Esquema 70/30)</li>
                            <li>50% para Basal e 50% para Bolus (Esquema Basal-Bolus)</li>
                        </ul>
                    </li>
                    <li>No esquema 70/30, a dose total é distribuída em:
                        <ul>
                            <li>2/3 da dose pela manhã</li>
                            <li>1/3 da dose à noite</li>
                        </ul>
                    </li>
                    <li>No esquema Basal-Bolus, a dose de bolus (50% da dose total) é distribuída em:
                        <ul>
                            <li>40% no café da manhã</li>
                            <li>30% no almoço
                                <li>30% no jantar</li>
                        </ul>
                    </li>
                </ol>
            </div>
            
            <div class="info-box" style="margin-top: 20px;">
                <h3>Informações Importantes</h3>
                <p><strong>1. Esquemas de Insulinoterapia</strong></p>
                <p>O esquema 70/30 (2 doses diárias) e o esquema basal-bolus (múltiplas doses) têm indicações diferentes. A escolha depende do perfil do paciente, capacidade de automonitoramento, rotina e objetivo glicêmico.</p>
                
                <p><strong>2. Horários de Administração</strong></p>
                <p>Seguir corretamente os horários de aplicação é essencial para um controle glicêmico adequado:
                <ul>
                    <li>Insulina regular: aplicar 30 minutos antes das refeições</li>
                    <li>Insulina ultrarrápida: aplicar 0-15 minutos antes das refeições</li>
                    <li>Insulina NPH: aplicar antes do café da manhã e ao deitar</li>
                    <li>Insulina basal (Glargina/Detemir): aplicar no mesmo horário diariamente</li>
                </ul>
                </p>
                
                <p><strong>3. Vias de Administração</strong></p>
                <p>A via de administração influencia diretamente na velocidade de absorção e duração do efeito:
                <ul>
                    <li>Subcutânea (SC): via padrão para uso ambulatorial, absorção mais lenta</li>
                    <li>Intravenosa (IV): uso hospitalar, início imediato (apenas insulina regular)</li>
                    <li>Intramuscular (IM): absorção intermediária, usada em situações de emergência</li>
                </ul>
                </p>
                
                <p><strong>4. Fatores que Afetam a Dose de Insulina</strong></p>
                <p>Além do peso, considere: idade, função renal, resistência insulínica, atividade física, uso de medicamentos (corticoides), presença de infecção/estresse e variação da dieta.</p>
                
                <p><strong>5. Educação do Paciente</strong></p>
                <p>Ensine o paciente sobre técnica de aplicação, rodízio de locais, reconhecimento de hipoglicemia e ajustes em situações especiais (exercício, doença aguda).</p>
                
                <p><strong>6. Monitoramento</strong></p>
                <p>O ajuste de doses deve ser feito com base em padrões glicêmicos, não em valores isolados. Analise tendências por pelo menos 3 dias consecutivos antes de modificar o esquema.</p>
                
                <p><strong>7. Transição de Esquemas</strong></p>
                <p>Ao migrar de um esquema para outro, considere sobreposição para evitar hiperglicemia ou hipoglicemia durante a transição.</p>
            </div>
        </div>
        
        <footer style="padding: 20px; text-align: center; border-top: 1px solid var(--border-color); margin-top: 30px;">
            <button id="referencesBtn" class="reference-btn" onclick="openReferencesModal()">
                <i class="fas fa-book"></i> Referências Bibliográficas
            </button>
        </footer>

        <!-- Modal de Referências com posição ajustada e ordem das seções alterada -->
        <div id="referencesModal" class="modal">
            <div class="modal-content references-modal">
                <span class="close-modal" onclick="closeReferencesModal()">&times;</span>
                <h2 class="modal-title">Referências Bibliográficas</h2>
                
                <!-- Movendo a contribuição técnica para o topo -->
                <div class="references-section">
                    <h3>Contribuição Técnica</h3>
                    <ol class="references-list">
                        <li><strong>Dr. George Ibiapina</strong> - Metodologia de cálculo por peso utilizada na primeira aba desta calculadora.</li>
                    </ol>
                </div>
                
                <div class="references-section">
                    <h3>Diretrizes e Consensos</h3>
                    <ol class="references-list" start="2">
                        <li>Sociedade Brasileira de Diabetes. (2022). <strong>Diretrizes da Sociedade Brasileira de Diabetes 2021-2022</strong>.</li>
                        <li>American Diabetes Association. (2022). <strong>Standards of Medical Care in Diabetes</strong>. <em>Diabetes Care</em>, 45(Supplement 1).</li>
                        <li>American Diabetes Association Professional Practice Committee. (2022). <strong>16. Diabetes Care in the Hospital: Standards of Medical Care in Diabetes-2022</strong>. <em>Diabetes Care</em>, 45(Supplement_1), S244-S253.</li>
                    </ol>
                </div>
                
                <div class="references-section">
                    <h3>Livros e Manuais</h3>
                    <ol class="references-list" start="5">
                        <li>Grossi, S. A. A., & Pascali, P. M. (2009). <strong>Cuidados de Enfermagem em Diabetes Mellitus</strong>. Manual de Enfermagem. Sociedade Brasileira de Diabetes.</li>
                        <li>Vilar, L. (Ed.). (2021). <strong>Endocrinologia Clínica</strong>. 7ª Ed. Guanabara Koogan.</li>
                        <li>Oliveira, J. E. P., Montenegro Junior, R. M., & Vencio, S. (2017). <strong>Diretrizes da Sociedade Brasileira de Diabetes 2017-2018</strong>. Editora Clannad.</li>
                    </ol>
                </div>
                
                <div class="references-section">
                    <h3>Artigos e Publicações</h3>
                    <ol class="references-list" start="8">
                        <li>Walsh, J., & Roberts, R. (2012). <strong>Pumping Insulin: Everything You Need to Know for Success with an Insulin Pump</strong>. Torrey Pines Press.</li>
                        <li>Davidson, P. C., Hebblewhite, H. R., Steed, R. D., & Bode, B. W. (2008). Analysis of guidelines for basal-bolus insulin dosing: Basal insulin, correction factor, and carbohydrate-to-insulin ratio. <em>Endocrine Practice</em>, 14(9), 1095-1101.</li>
                        <li>Moghissi, E. S., Korytkowski, M. T., DiNardo, M., Einhorn, D., Hellman, R., Hirsch, I. B., ... & Umpierrez, G. E. (2009). American Association of Clinical Endocrinologists and American Diabetes Association consensus statement on inpatient glycemic control. <em>Diabetes care</em>, 32(6), 1119-1131.</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal de Emergência -->
        <div id="modalEmergencia" class="modal">
            <div class="modal-content" style="max-width: 400px;">
                <span class="close-modal" onclick="fecharModalEmergencia()">&times;</span>
                <h2 class="modal-title">Acesso à Área de Emergência</h2>
                
                <div id="login-emergencia">
                    <p>Esta área contém protocolos e calculadoras para situações de emergência endocrinológica.</p>
                    <div class="form-group">
                        <label for="senhaEmergencia">Senha de Acesso:</label>
                        <input type="password" id="senhaEmergencia" placeholder="Digite a senha">
                    </div>
                    <button onclick="verificarSenha()"><i class="fas fa-lock-open"></i> Acessar</button>
                    <p id="erro-senha" style="color: red; display: none;">Senha incorreta. Tente novamente.</p>
                </div>
            </div>
        </div>
        </div>
        <script>
            // Função para alternar entre as abas
        // Função para alternar entre as abas
        document.addEventListener('DOMContentLoaded', function() {
            const tabLinks = document.querySelectorAll('.tab-link');
            
            // Adiciona evento de clique a todos os links de abas
            tabLinks.forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabId = this.getAttribute('data-tab');
                    openTab(tabId);
                });
            });
            
            // Inicializar a primeira aba como ativa
            openTab('peso');
            
            // Configurar os botões colapsáveis para o guia médico
            var coll = document.getElementsByClassName("collapsible");
            for (var i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function() {
                    this.classList.toggle("active-collapse");
                    var content = this.nextElementSibling;
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                    }
                });
            }
            
            // Configurar evento para o seletor de fator personalizado
            document.getElementById("selectFator").addEventListener("change", function() {
                if (this.value === "-1") {
                    document.getElementById("fatorPersonalizadoGroup").style.display = "block";
                } else {
                    document.getElementById("fatorPersonalizadoGroup").style.display = "none";
                }
            });
            
            // Configurar evento para o seletor de dose bomba personalizada
            document.getElementById("selectDoseBomba").addEventListener("change", function() {
                if (this.value === "-1") {
                    document.getElementById("doseBombaPersonalizadaGroup").style.display = "block";
                } else {
                    document.getElementById("doseBombaPersonalizadaGroup").style.display = "none";
                }
            });
        });

        // Função para abrir uma aba
        function openTab(tabName) {
            // Esconde todas as abas
            const tabContent = document.querySelectorAll('.tab-content');
            tabContent.forEach(function(tab) {
                tab.style.display = 'none';
                tab.classList.remove('active');
            });
            
            // Remove a classe "active" de todos os links
            const tabLinks = document.querySelectorAll('.tab-link');
            tabLinks.forEach(function(link) {
                link.classList.remove('active');
            });
            
            // Mostra a aba atual e adiciona a classe "active" ao link
            document.getElementById(tabName).style.display = 'block';
            document.getElementById(tabName).classList.add('active');
            
            // Ativa o link correspondente
            document.querySelector(`.tab-link[data-tab="${tabName}"]`).classList.add('active');
        }

        // Funções para os modais
        function openModal() {
            document.getElementById("aboutModal").style.display = "block";
        }

        function closeModal() {
            document.getElementById("aboutModal").style.display = "none";
        }

        function openReferencesModal() {
            document.getElementById("referencesModal").style.display = "block";
        }

        function closeReferencesModal() {
            document.getElementById("referencesModal").style.display = "none";
        }

        // Função para abrir o modal de emergência
        function abrirEmergencia() {
            document.getElementById("modalEmergencia").style.display = "block";
            document.getElementById("senhaEmergencia").value = "";
            document.getElementById("erro-senha").style.display = "none";
        }

        // Função para fechar o modal de emergência
        function fecharModalEmergencia() {
            document.getElementById("modalEmergencia").style.display = "none";
        }

        // Função para verificar a senha
        function verificarSenha() {
            const senha = document.getElementById("senhaEmergencia").value;
            if (senha === "endo2023") {
                window.location.href = "./emergencia.html";
            } else {
                document.getElementById("erro-senha").style.display = "block";
            }
        }

        // Fechar os modais quando clicar fora deles
        window.onclick = function(event) {
            if (event.target == document.getElementById("aboutModal")) {
                closeModal();
            }
            if (event.target == document.getElementById("referencesModal")) {
                closeReferencesModal();
            }
        }

        // Função para selecionar a via de administração
        function selectRoute(route) {
            // Remover classe active de todas as opções
            document.querySelectorAll('.route-option').forEach(function(option) {
                option.classList.remove('active');
            });
            
            // Adicionar classe active à opção selecionada
            document.getElementById('route-' + route).classList.add('active');
            
            // Atualizar a descrição conforme a via selecionada
            let description = "";
            switch(route) {
                case 'sc':
                    description = "Via subcutânea: Administração no tecido subcutâneo, geralmente abdômen, coxas ou braços.";
                    break;
                case 'iv':
                    description = "Via intravenosa: Administração direta na corrente sanguínea, uso hospitalar ou emergencial.";
                    break;
                case 'im':
                    description = "Via intramuscular: Administração no tecido muscular, absorção mais rápida que a subcutânea.";
                    break;
            }
            document.getElementById('route-description').textContent = description;
        }

        // Função para selecionar o tipo de insulina para bolus
        function selectInsulinType(type) {
            // Remover classe active de todas as opções
            document.querySelectorAll('.route-option').forEach(function(option) {
                option.classList.remove('active');
            });
            
            // Adicionar classe active à opção selecionada
            document.getElementById('insulin-' + type).classList.add('active');
            
            // Atualizar a descrição e o timing info conforme o tipo selecionado
            let description = "";
            let timingInfo = "";
            
            switch(type) {
                case 'regular':
                    description = "Insulina Regular: Início em 30min, pico em 2-3h, duração 5-8h. Aplicar 30min antes das refeições.";
                    timingInfo = `
                        <strong>Insulina Regular:</strong> 
                        <ul class="timing-list">
                            <li><i class="fas fa-angle-right"></i> Aplicar 30 minutos antes da refeição</li>
                            <li><i class="fas fa-angle-right"></i> Esperar absorção antes de se alimentar para evitar picos glicêmicos</li>
                        </ul>
                    `;
                    break;
                case 'rapid':
                    description = "Insulina Ultrarrápida: Início em 10-15min, pico em 1-2h, duração 3-5h. Aplicar 0-15min antes das refeições.";
                    timingInfo = `
                        <strong>Insulina Ultrarrápida:</strong> 
                        <ul class="timing-list">
                            <li><i class="fas fa-angle-right"></i> Aplicar 0-15 minutos antes da refeição</li>
                            <li><i class="fas fa-angle-right"></i> Pode ser aplicada imediatamente antes ou até logo após iniciar a refeição</li>
                        </ul>
                    `;
                    break;
            }
            document.getElementById('insulin-description').innerHTML = description;
            
            // Se os resultados do bolus estiverem visíveis, atualizar o timing info
            if (document.getElementById('resultadosBolus').style.display === 'block') {
                document.getElementById('bolus-timing-info').innerHTML = timingInfo;
            }
        }

        // Função para formatar números com uma casa decimal
        function formatarNumero(valor) {
            return parseFloat(valor).toFixed(1);
        }

        // Função para calcular dose baseada no peso (CORRIGIDA)
        function calcularPeso() {
            var peso = parseFloat(document.getElementById("inputPeso").value);
            
            // Validar entrada
            if (isNaN(peso) || peso <= 0) {
                alert("Por favor, insira um peso válido.");
                return;
            }
            
            // Obter o fator correto
            var fatorSelect = document.getElementById("selectFator");
            var fator;
            
            if (fatorSelect.value === "-1") {
                fator = parseFloat(document.getElementById("inputFatorPersonalizado").value);
                if (isNaN(fator) || fator <= 0) {
                    alert("Por favor, insira um fator personalizado válido.");
                    return;
                }
            } else {
                fator = parseFloat(fatorSelect.value);
            }
            
            // Cálculo principal: Peso * Fator = Dose total
            var doseTotal = peso * fator;
            
            // Divisão principal (70% Intermediária, 30% Rápida)
            var doseIntermediaria = doseTotal * 0.7;
            var doseRapida = doseTotal * 0.3;
            
            // Esquema duas doses (2/3 manhã, 1/3 noite)
            var doseManha = doseTotal * (2/3);
            var doseNoite = doseTotal * (1/3);
            
            // Manhã (2/3)
            // CORREÇÃO: Cada tipo de insulina (intermediária e rápida) é dividida em 50% para manhã e 50% para noite
            var intermediariaManha = doseManha * 0.7 * 0.5;
            var rapidaManha = doseManha * 0.3 * 0.5;
            
            // Noite (1/3)
            var intermediariaNoite = doseNoite * 0.7 * 0.5;
            var rapidaNoite = doseNoite * 0.3 * 0.5;
            
            // Esquema basal-bolus alternativo (50/50)
            var basal = doseTotal * 0.5;
            var bolusTotal = doseTotal * 0.5;
            
            // Dividir bolus em 3 refeições
            var bolusCafe = bolusTotal * 0.4;  // 40% no café
            var bolusAlmoco = bolusTotal * 0.3;  // 30% no almoço
            var bolusJantar = bolusTotal * 0.3;  // 30% no jantar
            
            // Exibir resultados
            document.getElementById("doseTotalPeso").textContent = formatarNumero(doseTotal);
            document.getElementById("doseIntermediaria").textContent = formatarNumero(doseIntermediaria);
            document.getElementById("doseRapida").textContent = formatarNumero(doseRapida);
            document.getElementById("doseManha").textContent = formatarNumero(doseManha);
            document.getElementById("intermediariaManha").textContent = formatarNumero(intermediariaManha);
            document.getElementById("rapidaManha").textContent = formatarNumero(rapidaManha);
            document.getElementById("doseNoite").textContent = formatarNumero(doseNoite);
            document.getElementById("intermediariaNoite").textContent = formatarNumero(intermediariaNoite);
            document.getElementById("rapidaNoite").textContent = formatarNumero(rapidaNoite);
            document.getElementById("doseBasal").textContent = formatarNumero(basal);
            document.getElementById("bolusTotal").textContent = formatarNumero(bolusTotal);
            document.getElementById("bolusCafe").textContent = formatarNumero(bolusCafe);
            document.getElementById("bolusAlmoco").textContent = formatarNumero(bolusAlmoco);
            document.getElementById("bolusJantar").textContent = formatarNumero(bolusJantar);
            
            document.getElementById("resultadosPeso").style.display = "block";
        }

        // Função para calcular regras 500/1800
        function calcularRegras() {
            var doseTotal = parseFloat(document.getElementById("inputDoseTotal").value);
            
            // Validar entrada
            if (isNaN(doseTotal) || doseTotal <= 0) {
                alert("Por favor, insira uma dose total diária válida.");
                return;
            }
            
            // Regra dos 500 - Razão insulina/carboidrato
            var razaoIC500 = 500 / doseTotal;
            
            // Regra dos 450 - Variação para razão IC
            var razaoIC450 = 450 / doseTotal;
            
            // Regra dos 1800 - Fator de sensibilidade à insulina (FSI) em mg/dL
            var fsi1800 = 1800 / doseTotal;
            
            // Regra dos 1500 - Variação do FSI
            var fsi1500 = 1500 / doseTotal;
            
            // Exibir resultados
            document.getElementById("razaoIC500").textContent = formatarNumero(razaoIC500);
            document.getElementById("razaoIC450").textContent = formatarNumero(razaoIC450);
            document.getElementById("fsi1800").textContent = formatarNumero(fsi1800);
            document.getElementById("fsi1500").textContent = formatarNumero(fsi1500);
            
            document.getElementById("resultadosRegras").style.display = "block";
        }

        // Função para calcular bolus
        function calcularBolus() {
            var glicemiaAtual = parseFloat(document.getElementById("inputGlicemiaAtual").value);
            var glicemiaAlvo = parseFloat(document.getElementById("inputGlicemiaAlvo").value);
            var carboidratos = parseFloat(document.getElementById("inputCarboidratos").value);
            var razaoIC = parseFloat(document.getElementById("inputRazaoIC").value);
            var fsi = parseFloat(document.getElementById("inputFSI").value);
            
            // Validar entradas
            if (isNaN(glicemiaAtual) || isNaN(glicemiaAlvo) || isNaN(razaoIC) || isNaN(fsi)) {
                alert("Por favor, preencha todos os campos obrigatórios com valores válidos.");
                return;
            }
            
            if (razaoIC <= 0 || fsi <= 0) {
                alert("Razão IC e FSI devem ser maiores que zero.");
                return;
            }
            
            // Se não houver carboidratos, definir como 0
            if (isNaN(carboidratos)) {
                carboidratos = 0;
            }
            
            // Cálculo do bolus de correção
            var diferencaGlicemia = Math.max(0, glicemiaAtual - glicemiaAlvo);
            var bolusCorrecao = diferencaGlicemia / fsi;
            
            // Cálculo do bolus alimentar
            var bolusAlimentar = carboidratos / razaoIC;
            
            // Bolus total
            var bolusTotal = bolusCorrecao + bolusAlimentar;
            
            // Exibir resultados
            document.getElementById("diferencaGlicemia").textContent = formatarNumero(diferencaGlicemia);
            document.getElementById("bolusCorrecao").textContent = formatarNumero(bolusCorrecao);
            document.getElementById("bolusAlimentar").textContent = formatarNumero(bolusAlimentar);
            document.getElementById("bolusTotalFinal").textContent = formatarNumero(bolusTotal);
            
            // Atualizar timing info baseado no tipo de insulina selecionado
            let timingInfo = "";
            if (document.getElementById('insulin-rapid').classList.contains('active')) {
                timingInfo = `
                    <strong>Insulina Ultrarrápida:</strong> 
                    <ul class="timing-list">
                        <li><i class="fas fa-angle-right"></i> Aplicar 0-15 minutos antes da refeição</li>
                        <li><i class="fas fa-angle-right"></i> Pode ser aplicada imediatamente antes ou até logo após iniciar a refeição</li>
                    </ul>
                `;
            } else {
                timingInfo = `
                    <strong>Insulina Regular:</strong> 
                    <ul class="timing-list">
                        <li><i class="fas fa-angle-right"></i> Aplicar 30 minutos antes da refeição</li>
                        <li><i class="fas fa-angle-right"></i> Esperar absorção antes de se alimentar para evitar picos glicêmicos</li>
                    </ul>
                `;
            }
            document.getElementById('bolus-timing-info').innerHTML = timingInfo;
            
            document.getElementById("resultadosBolus").style.display = "block";
        }
        
        // Função para calcular doses para bomba de infusão
        function calcularBomba() {
            var peso = parseFloat(document.getElementById("inputPesoBomba").value);
            var doseBombaSelect = document.getElementById("selectDoseBomba");
            var doseBomba;
            
            // Validar entrada
            if (isNaN(peso) || peso <= 0) {
                alert("Por favor, insira um peso válido.");
                return;
            }
            
            // Obter a dose correta
            if (doseBombaSelect.value === "-1") {
                doseBomba = parseFloat(document.getElementById("inputDoseBombaPersonalizada").value);
                if (isNaN(doseBomba) || doseBomba <= 0) {
                    alert("Por favor, insira uma dosagem personalizada válida.");
                    return;
                }
            } else {
                doseBomba = parseFloat(doseBombaSelect.value);
            }
            
            // Obter a concentração
            var concentracao = parseFloat(document.getElementById("selectConcentracao").value);
            
            // Cálculos
            var doseHoraria = peso * doseBomba;
            var volumeInfusao = doseHoraria / concentracao;
            var velocidadeInfusao = volumeInfusao;
            
            var doseDia = doseHoraria * 24;
            var volumeDia = volumeInfusao * 24;
            
            // Exibir resultados
            document.getElementById("doseHorariaBomba").textContent = formatarNumero(doseHoraria);
            document.getElementById("volumeInfusao").textContent = formatarNumero(volumeInfusao);
            document.getElementById("velocidadeInfusao").textContent = formatarNumero(velocidadeInfusao);
            document.getElementById("doseDia").textContent = formatarNumero(doseDia);
            document.getElementById("volumeDia").textContent = formatarNumero(volumeDia);
            document.getElementById("resultadosBomba").style.display = "block";
        }
    </script>
</body>
</html>



