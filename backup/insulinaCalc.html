<script>
    // Função para alternar entre as abas
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        
        // Esconde todas as abas
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        
        // Remove a classe "active" de todos os botões
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        
        // Mostra a aba atual e adiciona a classe "active" ao botão
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }
    
    // Mostrar/esconder o campo de fator personalizado
    document.getElementById("selectFator").addEventListener("change", function() {
        if (this.value === "-1") {
            document.getElementById("fatorPersonalizadoGroup").style.display = "block";
        } else {
            document.getElementById("fatorPersonalizadoGroup").style.display = "none";
        }
    });
    
    // Função para formatar números com uma casa decimal
    function formatarNumero(valor) {
        return parseFloat(valor).toFixed(1);
    }
    
    // Função para calcular dose baseada no peso
    function calcularPeso() {
        var peso = parseFloat(document.getElementById("inputPeso").value);
        
        // Validar entrada
        if (isNaN(peso) || peso <= 0) {
            alert("Por favor, insira um peso válido.");
            return;
        }
        
        // Obter o fator correto
        var fatorSelect = document.getElementById("selectFator");
        var fator;
        
        if (fatorSelect.value === "-1") {
            fator = parseFloat(document.getElementById("inputFatorPersonalizado").value);
            if (isNaN(fator) || fator <= 0) {
                alert("Por favor, insira um fator personalizado válido.");
                return;
            }
        } else {
            fator = parseFloat(fatorSelect.value);
        }
        
        // Cálculo principal: Peso * Fator = Dose total
        var doseTotal = peso * fator;
        
        // Divisão principal (70% NPH, 30% Regular)
        var doseNPH = doseTotal * 0.7;
        var doseRegular = doseTotal * 0.3;
        
        // Esquema duas doses (2/3 manhã, 1/3 noite)
        var doseManha = doseTotal * (2/3);
        var doseNoite = doseTotal * (1/3);
        
        // Manhã (2/3)
        var nphManha = doseManha * 0.7;
        var regularManha = doseManha * 0.3;
        
        // Noite (1/3)
        var nphNoite = doseNoite * 0.7;
        var regularNoite = doseNoite * 0.3;
        
        // Esquema basal-bolus alternativo (50/50)
        var basal = doseTotal * 0.5;
        var bolusTotal = doseTotal * 0.5;
        
        // Dividir bolus em 3 refeições
        var bolusCafe = bolusTotal * 0.4;  // 40% no café
        var bolusAlmoco = bolusTotal * 0.3;  // 30% no almoço
        var bolusJantar = bolusTotal * 0.3;  // 30% no jantar
        
        // Exibir resultados
        document.getElementById("doseTotalPeso").textContent = formatarNumero(doseTotal);
        document.getElementById("doseNPH").textContent = formatarNumero(doseNPH);
        document.getElementById("doseRegular").textContent = formatarNumero(doseRegular);
        document.getElementById("doseManha").textContent = formatarNumero(doseManha);
        document.getElementById("nphManha").textContent = formatarNumero(nphManha);
        document.getElementById("regularManha").textContent = formatarNumero(regularManha);
        document.getElementById("doseNoite").textContent = formatarNumero(doseNoite);
        document.getElementById("nphNoite").textContent = formatarNumero(nphNoite);
        document.getElementById("regularNoite").textContent = formatarNumero(regularNoite);
        document.getElementById("doseBasal").textContent = formatarNumero(basal);
        document.getElementById("bolusTotal").textContent = formatarNumero(bolusTotal);
        document.getElementById("bolusCafe").textContent = formatarNumero(bolusCafe);
        document.getElementById("bolusAlmoco").textContent = formatarNumero(bolusAlmoco);
        document.getElementById("bolusJantar").textContent = formatarNumero(bolusJantar);
        
        document.getElementById("resultadosPeso").style.display = "block";
    }
    
    // Função para calcular regras 500/1800
    function calcularRegras() {
        var doseTotal = parseFloat(document.getElementById("inputDoseTotal").value);
        
        // Validar entrada
        if (isNaN(doseTotal) || doseTotal <= 0) {
            alert("Por favor, insira uma dose total diária válida.");
            return;
        }
        
        // Regra dos 500 - Razão insulina/carboidrato
        var razaoIC500 = 500 / doseTotal;
        
        // Regra dos 450 - Variação para razão IC
        var razaoIC450 = 450 / doseTotal;
        
        // Regra dos 1800 - Fator de sensibilidade à insulina (FSI) em mg/dL
        var fsi1800 = 1800 / doseTotal;
        
        // Regra dos 1500 - Variação do FSI
        var fsi1500 = 1500 / doseTotal;
        
        // Exibir resultados
        document.getElementById("razaoIC500").textContent = formatarNumero(razaoIC500);
        document.getElementById("razaoIC450").textContent = formatarNumero(razaoIC450);
        document.getElementById("fsi1800").textContent = formatarNumero(fsi1800);
        document.getElementById("fsi1500").textContent = formatarNumero(fsi1500);
        
        document.getElementById("resultadosRegras").style.display = "block";
    }
    
    // Função para calcular bolus
    function calcularBolus() {
        var glicemiaAtual = parseFloat(document.getElementById("inputGlicemiaAtual").value);
        var glicemiaAlvo = parseFloat(document.getElementById("inputGlicemiaAlvo").value);
        var carboidratos = parseFloat(document.getElementById("inputCarboidratos").value);
        var razaoIC = parseFloat(document.getElementById("inputRazaoIC").value);
        var fsi = parseFloat(document.getElementById("inputFSI").value);
        
        // Validar entradas
        if (isNaN(glicemiaAtual) || isNaN(glicemiaAlvo) || isNaN(carboidratos) || isNaN(razaoIC) || isNaN(fsi)) {
            alert("Por favor, preencha todos os campos com valores válidos.");
            return;
        }
        
        if (razaoIC <= 0 || fsi <= 0) {
            alert("Razão IC e FSI devem ser maiores que zero.");
            return;
        }
        
        // Cálculo do bolus de correção
        var diferencaGlicemia = Math.max(0, glicemiaAtual - glicemiaAlvo);
        var bolusCorrecao = diferencaGlicemia / fsi;
        
        // Cálculo do bolus alimentar
        var bolusAlimentar = carboidratos / razaoIC;
        
        // Bolus total
        var bolusTotal = bolusCorrecao + bolusAlimentar;
        
        // Exibir resultados
        document.getElementById("diferencaGlicemia").textContent = formatarNumero(diferencaGlicemia);
        document.getElementById("bolusCorrecao").textContent = formatarNumero(bolusCorrecao);
        document.getElementById("bolusAlimentar").textContent = formatarNumero(bolusAlimentar);
        document.getElementById("bolusTotalFinal").textContent = formatarNumero(bolusTotal);
        
        document.getElementById("resultadosBolus").style.display = "block";
    }
    
    // Configurar os botões colapsáveis para o guia médico
    var coll = document.getElementsByClassName("collapsible");
    for (var i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
            this.classList.toggle("active-collapse");
            var content = this.nextElementSibling;
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
            }
        });
    }
</script>
</body>
</html>document.getElementById("inputGlicemiaAtual").value);
        var glicemiaAlvo = parseFloat(<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Insulina</title>
<style>
</style>
        <h2>Guia Médico - Insulinoterapia</h2>
        
        <button class="collapsible">Tipos de Insulina e Farmacocinética</button>
        <div class="collapse-content">
            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                <tr style="background-color: #f2f2f2; font-weight: bold;">
                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">Tipo</th>
                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">Início de ação</th>
                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">Pico</th>
                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">Duração</th>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;">Ultra-rápida (Lispro, Aspart, Glulisina)</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">10-15 min</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">1-2h</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">3-5h</td>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;">Rápida (Regular)</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">30 min</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">2-3h</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">5-8h</td>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;">Intermediária (NPH)</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">2-4h</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">4-10h</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">10-16h</td>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;">Longa (Glargina)</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">2-4h</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">Sem pico</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">20-24h</td>
                </tr>
                <tr>
                    <td style="padding: 8px; border: 1px solid #ddd;">Ultra-longa (Degludeca)</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">1-2h</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">Sem pico</td>
                    <td style="padding: 8px; border: 1px solid #ddd;">>42h</td>
                </tr>
            </table>
            <p><strong>Observação:</strong> A insulina NPH apresenta grande variabilidade entre pacientes e mesmo no mesmo paciente em dias diferentes.</p>
        </div>
        
        <button class="collapsible">Esquemas de Tratamento</button>
        <div class="collapse-content">
            <h4>1. Esquema Convencional (70/30 ou 2 doses)</h4>
            <p>Mais simples, menos flexível, geralmente 2 injeções por dia (manhã e noite).</p>
            <ul>
                <li><strong>2/3 da dose pela manhã:</strong> 70% NPH + 30% Regular (antes do café)</li>
                <li><strong>1/3 da dose à noite:</strong> 70% NPH + 30% Regular (antes do jantar)</li>
            </ul>
            <p><strong>Indicações:</strong> Pacientes com rotina regular, idosos, dificuldade de adesão a esquemas complexos.</p>
            
            <h4>2. Esquema Basal-Bolus (múltiplas doses)</h4>
            <p>Mais fisiológico, flexível, geralmente 4 injeções por dia.</p>
            <ul>
                <li><strong>Basal (50% da dose total):</strong> Insulina de ação longa 1x/dia (Glargina, Degludeca) ou NPH 2x/dia</li>
                <li><strong>Bolus (50% da dose total):</strong> Insulina de ação rápida antes das refeições
                    <ul>
                        <li>40% no café da manhã</li>
                        <li>30% no almoço</li>
                        <li>30% no jantar</li>
                    </ul>
                </li>
            </ul>
            <p><strong>Indicações:</strong> DM1, gestantes, rotina variável, melhor controle glicêmico.</p>
            
            <h4>3. Esquema Misto Adaptado</h4>
            <p>Flexibilidade intermediária.</p>
            <ul>
                <li><strong>Basal:</strong> Insulina de ação longa 1x/dia</li>
                <li><strong>Correções:</strong> Insulina de ação rápida de acordo com as glicemias capilares</li>
            </ul>
            <p><strong>Indicações:</strong> Pacientes com dificuldade para múltiplas doses mas que precisam de melhor controle.</p>
        </div>
        
        <button class="collapsible">Ajustes de Dose e Monitoramento</button>
        <div class="collapse-content">
            <h4>Monitoramento ideal para ajuste:</h4>
            <ul>
                <li>Glicemia de jejum (ajusta basal noturna)</li>
                <li>Glicemia pré-almoço (ajusta basal matinal)</li>
                <li>Glicemia pré-jantar (ajusta basal vespertina)</li>
                <li>Glicemia 2h pós-refeições (ajusta bolus)</li>
            </ul>
            
            <h4>Regras para ajuste de dose:</h4>
            <ul>
                <li><strong>Ajustes lentos e pequenos:</strong> 10-20% da dose a cada 2-3 dias</li>
                <li><strong>Hipoglicemias:</strong> Reduzir dose da insulina correspondente ao período em 20%</li>
                <li><strong>Hiperglicemia persistente:</strong> Aumentar insulina correspondente ao período em 10-20%</li>
                <li><strong>Fenômeno do alvorecer:</strong> Hiperglicemia matinal por aumento de hormônios contrarreguladores; pode requerer ajuste na NPH noturna ou Glargina</li>
            </ul>
            
            <h4>Alvo glicêmico:</h4>
            <ul>
                <li><strong>Jovens saudáveis:</strong> 80-130 mg/dL (jejum) e <180 mg/dL (pós-prandial)</li>
                <li><strong>Idosos ou com comorbidades:</strong> 100-180 mg/dL (jejum) e <200 mg/dL (pós-prandial)</li>
                <li><strong>Gestantes:</strong> <95 mg/dL (jejum) e <120 mg/dL (pós-prandial)</li>
            </ul>
        </div>
        
        <button class="collapsible">Complicações e Manejo</button>
        <div class="collapse-content">
            <h4>Hipoglicemia:</h4>
            <p><strong>Definição:</strong> Glicemia <70 mg/dL</p>
            <ul>
                <li><strong>Tratamento:</strong> 
                    <ul>
                        <li>Paciente consciente: 15g de carboidrato rápido (3 colheres de açúcar, 150ml de suco)</li>
                        <li>Paciente inconsciente: Glucagon IM/SC ou Glicose 50% EV</li>
                    </ul>
                </li>
                <li><strong>Prevenção:</strong> 
                    <ul>
                        <li>Monitoramento frequente</li>
                        <li>Ajuste de dose (reduzir em 20% se hipoglicemias frequentes)</li>
                        <li>Considerar lanches intermediários</li>
                    </ul>
                </li>
            </ul>
            
            <h4>Lipodistrofia:</h4>
            <ul>
                <li>Alteração do tecido subcutâneo por injeções repetidas no mesmo local</li>
                <li><strong>Impacto:</strong> Absorção errática de insulina</li>
                <li><strong>Prevenção:</strong> Rodízio dos locais de aplicação</li>
            </ul>
            
            <h4>Efeito Somogyi:</h4>
            <p>Hiperglicemia matinal paradoxal após hipoglicemia noturna (rebote hiperglicêmico).</p>
            <p><strong>Manejo:</strong> Reduzir dose de insulina noturna.</p>
        </div>
        
        <button class="collapsible">Situações Especiais</button>
        <div class="collapse-content">
            <h4>Paciente hospitalizado:</h4>
            <ul>
                <li><strong>Não crítico:</strong> Esquema basal-bolus-correção. Evitar sliding scale isolado</li>
                <li><strong>Crítico:</strong> Infusão EV contínua, alvo 140-180 mg/dL</li>
                <li><strong>Jejum para procedimentos:</strong> 50-80% da basal, suspender bolus</li>
            </ul>
            
            <h4>Paciente com Doença Renal Crônica:</h4>
            <ul>
                <li>Maior risco de hipoglicemia por redução da degradação renal de insulina</li>
                <li>Reduzir doses em 25-50% conforme TFG</li>
                <li>Preferir insulinas com metabolização hepática (Detemir)</li>
            </ul>
            
            <h4>Paciente corticodependente:</h4>
            <ul>
                <li>Aumento importante da resistência à insulina</li>
                <li>Pode requerer 30-40% a mais de insulina</li>
                <li>Maior necessidade de bolus à tarde se corticoide matinal</li>
            </ul>
            
            <h4>Gravidez:</h4>
            <ul>
                <li>Controle rigoroso: jejum <95 mg/dL, 1h pós-prandial <140 mg/dL, 2h <120 mg/dL</li>
                <li>Esquema basal-bolus preferencial</li>
                <li>Necessidade crescente de insulina ao longo da gestação</li>
            </ul>
        </div>
        
        <button class="collapsible">Pearls para Prescrição e Acompanhamento</button>
        <div class="collapse-content">
            <ul>
                <li>Informe ao paciente que em média são necessários 3 dias para que um ajuste de dose basal se estabilize e mostre resultados;</li>
                <li>Considerar o momento alimentar em relação ao pico da insulina: Regular deve ser aplicada 30 min antes das refeições;</li>
                <li>Pacientes com neuropatia autonômica podem não perceber sintomas adrenérgicos de hipoglicemia - monitoramento mais frequente;</li>
                <li>Uma simples regra prática: para cada 30 mg/dL acima do alvo, adicione 2U de insulina de correção;</li>
                <li>Ao iniciar corticoterapia, aumente a dose de insulina em 20% e monitore para ajustes adicionais;</li>
                <li>O efeito cumulativo da insulina NPH pode causar hipoglicemias tardias - atenção aos esquemas BID;</li>
                <li>Exercícios podem aumentar a sensibilidade à insulina por até 48h - oriente redução de dose para atividades não rotineiras;</li>
                <li>Infecções e estresse agudo podem aumentar a necessidade de insulina em 20-50%;</li>
                <li>Bolus prandial: aplique antes das refeições. Bolus de correção: pode ser aplicado a qualquer momento;</li>
                <li>Na ausência de automonitoramento, prefira esquemas menos intensivos e mais previsíveis.</li>
            </ul>
            </div>
        </div>
    </div>
    </style>
    * {
        font-family: Arial, sans-serif;
    }
    
    body {
        margin: 0;
        padding: 10px;
        background-color: #f5f5f5;
        color: #333;
    }
    
    h1, h2, h3 {
        color: #2c3e50;
    }
    
    .container {
        max-width: 600px;
        margin: 0 auto;
        background-color: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    
    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
        border-radius: 5px 5px 0 0;
        display: flex;
        width: 100%;
    }
    
    .tab button {
        background-color: inherit;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 12px 0;
        transition: 0.3s;
        font-size: 14px;
        flex: 1;
        text-align: center;
    }
    
    .tab button:hover {
        background-color: #ddd;
    }
    
    .tab button.active {
        background-color: #4a89dc;
        color: white;
    }
    
    .tabcontent {
        display: none;
        padding: 15px;
        border: 1px solid #ccc;
        border-top: none;
        border-radius: 0 0 5px 5px;
        animation: fadeEffect 1s;
    }
    
    @keyframes fadeEffect {
        from {opacity: 0;}
        to {opacity: 1;}
    }
    
    /* Estilos adicionais para dispositivos móveis */
    @media screen and (max-width: 480px) {
        .tab button {
            font-size: 12px;
            padding: 10px 0;
        }
        
        .container {
            padding: 10px;
        }
        
        h1 {
            font-size: 20px;
        }
        
        h2 {
            font-size: 18px;
        }
        
        .results, .info-box {
            padding: 10px;
        }
    }
    
    .form-group {
        margin-bottom: 15px;
    }
    
    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }
    
    input, select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
    }
    
    button {
        background-color: #4a89dc;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
        width: 100%;
    }
    
    button:hover {
        background-color: #3a69b0;
    }
    
    .results {
        margin-top: 20px;
        padding: 15px;
        background-color: #f9f9f9;
        border-radius: 5px;
        border-left: 4px solid #4a89dc;
    }
    
    .result-item {
        margin-bottom: 8px;
    }
    
    .result-label {
        font-weight: bold;
    }
    
    .info-box {
        margin-top: 20px;
        padding: 15px;
        background-color: #f0f7ff;
        border-radius: 5px;
        border-left: 4px solid #5bc0de;
    }
    
    .warning {
        font-weight: bold;
    }
    
    .section-title {
        margin-top: 15px;
        padding-bottom: 5px;
        border-bottom: 1px solid #eee;
    }
    
    .indent {
        margin-left: 20px;
    }
    
    /* Área para estudos médicos */
    .medical-notes {
        margin-top: 20px;
        padding: 15px;
        background-color: #f5f8ff;
        border-radius: 5px;
        border-left: 4px solid #3a6bdb;
    }
    
    .collapsible {
        background-color: #f1f1f1;
        color: #444;
        cursor: pointer;
        padding: 12px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 15px;
        border-radius: 4px;
        margin-bottom: 5px;
        font-weight: bold;
    }
    
    .active-collapse, .collapsible:hover {
        background-color: #e0e0e0;
    }
    
    .collapsible:after {
        content: '\\002B'; /* Unicode character for "plus" sign (+) */
        font-weight: bold;
        float: right;
        margin-left: 5px;
    }
    
    .active-collapse:after {
        content: "\\2212"; /* Unicode character for "minus" sign (-) */
    }
    
    .collapse-content {
        padding: 0 18px;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.2s ease-out;
        background-color: #f9f9f9;
        border-radius: 0 0 4px 4px;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Calculadora de Insulina</h1>
    <p>Auxílio no cálculo de doses de insulina com base em diferentes métodos</p>
    
    <div class="tab">
        <button class="tablinks active" onclick="openTab(event, 'peso')">Cálculo por Peso</button>
        <button class="tablinks" onclick="openTab(event, 'regras')">Regras 500/1800</button>
        <button class="tablinks" onclick="openTab(event, 'bolus')">Cálculo de Bolus</button>
        <button class="tablinks" onclick="openTab(event, 'medicalInfo')">Guia Médico</button>
    </div>
    
    <!-- Aba 1: Cálculo por Peso -->
    <div id="peso" class="tabcontent" style="display: block;">
        <h2>Cálculo baseado no Peso</h2>
        
        <div class="form-group">
            <label for="inputPeso">Peso (kg):</label>
            <input type="number" id="inputPeso" placeholder="Digite o peso em kg" min="0.1" max="300" step="0.1">
        </div>
        
        <div class="form-group">
            <label for="selectFator">Fator (U/kg):</label>
            <select id="selectFator">
                <option value="0.3">0,3 - Muito sensível</option>
                <option value="0.5">0,5 - Sensível</option>
                <option value="0.7" selected>0,7 - Padrão</option>
                <option value="1.0">1,0 - Resistente</option>
                <option value="1.5">1,5 - Muito resistente</option>
                <option value="2.0">2,0 - Extremamente resistente</option>
                <option value="-1">Personalizado</option>
            </select>
        </div>
        
        <div class="form-group" id="fatorPersonalizadoGroup" style="display: none;">
            <label for="inputFatorPersonalizado">Fator personalizado:</label>
            <input type="number" id="inputFatorPersonalizado" placeholder="Digite o fator personalizado" min="0.1" max="10" step="0.1">
        </div>
        
        <button onclick="calcularPeso()">Calcular Doses</button>
        
        <div id="resultadosPeso" class="results" style="display: none;">
            <h3>Resultados</h3>
            
            <div class="result-item">
                <span class="result-label">Dose Total Diária:</span> 
                <span id="doseTotalPeso">--</span> U
            </div>
            
            <h4 class="section-title">Esquema 70/30 (NPH/Regular):</h4>
            
            <div class="result-item">
                <span class="result-label">NPH Total (70%):</span> 
                <span id="doseNPH">--</span> U
            </div>
            
            <div class="result-item">
                <span class="result-label">Regular Total (30%):</span> 
                <span id="doseRegular">--</span> U
            </div>
            
            <h4 class="section-title">Distribuição em 2 doses diárias:</h4>
            
            <div class="result-item">
                <span class="result-label">Dose Matinal (2/3):</span> 
                <span id="doseManha">--</span> U
            </div>
            
            <div class="result-item indent">
                <span class="result-label">NPH Manhã:</span> 
                <span id="nphManha">--</span> U
            </div>
            
            <div class="result-item indent">
                <span class="result-label">Regular Manhã:</span> 
                <span id="regularManha">--</span> U
            </div>
            
            <div class="result-item">
                <span class="result-label">Dose Noturna (1/3):</span> 
                <span id="doseNoite">--</span> U
            </div>
            
            <div class="result-item indent">
                <span class="result-label">NPH Noite:</span> 
                <span id="nphNoite">--</span> U
            </div>
            
            <div class="result-item indent">
                <span class="result-label">Regular Noite:</span> 
                <span id="regularNoite">--</span> U
            </div>
            
            <h4 class="section-title">Esquema Basal-Bolus (50/50):</h4>
            
            <div class="result-item">
                <span class="result-label">Insulina Basal (50%):</span> 
                <span id="doseBasal">--</span> U
            </div>
            
            <div class="result-item">
                <span class="result-label">Insulina Bolus Total (50%):</span> 
                <span id="bolusTotal">--</span> U
            </div>
            
            <div class="result-item indent">
                <span class="result-label">Bolus Café (40%):</span> 
                <span id="bolusCafe">--</span> U
            </div>
            
            <div class="result-item indent">
                <span class="result-label">Bolus Almoço (30%):</span> 
                <span id="bolusAlmoco">--</span> U
            </div>
            
            <div class="result-item indent">
                <span class="result-label">Bolus Jantar (30%):</span> 
                <span id="bolusJantar">--</span> U
            </div>
        </div>
        
        <div class="info-box">
            <h4>Informações sobre o cálculo:</h4>
            <p><strong>Dose Total Diária:</strong> Geralmente calculada como 0,5 a 1,0 unidades por kg de peso corporal.</p>
            <p><strong>Esquema 70/30:</strong> Divisão clássica em 70% NPH (insulina intermediária) e 30% Regular (insulina rápida).</p>
            <p><strong>Distribuição diária:</strong> Tipicamente 2/3 da dose pela manhã e 1/3 à noite.</p>
            <p><strong>Esquema Basal-Bolus:</strong> Alternativa com 50% da dose como insulina basal e 50% como bolus distribuídos nas refeições.</p>
            <p>Esta calculadora é uma ferramenta educativa. Ajustes individualizados devem ser feitos com base nos diversos fatores clínicos e resposta do paciente.</p>
        </div>
    </div>
    
    <!-- Aba 2: Regras 500/1800 -->
    <div id="regras" class="tabcontent">
        <h2>Regras 500/1800</h2>
        
        <div class="form-group">
            <label for="inputDoseTotal">Dose Total Diária (U):</label>
            <input type="number" id="inputDoseTotal" placeholder="Digite a dose total diária" min="1" max="200" step="0.1">
        </div>
        
        <button onclick="calcularRegras()">Calcular Fatores</button>
        
        <div id="resultadosRegras" class="results" style="display: none;">
            <h3>Resultados</h3>
            
            <h4 class="section-title">Razão Insulina/Carboidrato:</h4>
            
            <div class="result-item">
                <span class="result-label">Regra dos 500:</span> 
                <span id="razaoIC500">--</span> g de carboidrato por 1U de insulina
            </div>
            
            <div class="result-item">
                <span class="result-label">Regra dos 450:</span> 
                <span id="razaoIC450">--</span> g de carboidrato por 1U de insulina
            </div>
            
            <h4 class="section-title">Fator de Sensibilidade à Insulina (FSI):</h4>
            
            <div class="result-item">
                <span class="result-label">Regra dos 1800:</span> 
                <span id="fsi1800">--</span> mg/dL reduzidos por 1U de insulina
            </div>
            
            <div class="result-item">
                <span class="result-label">Regra dos 1500:</span> 
                <span id="fsi1500">--</span> mg/dL reduzidos por 1U de insulina
            </div>
        </div>
        
        <div class="info-box">
            <h4>Explicação:</h4>
            <p><strong>Regra dos 500:</strong> Determina quantos gramas de carboidrato são cobertos por 1 unidade de insulina.</p>
            <p><strong>Fórmula:</strong> 500 ÷ Dose Total Diária = g de carboidrato por 1U de insulina</p>
            <p><strong>Regra dos 1800:</strong> Determina quantos mg/dL a glicemia será reduzida por 1 unidade de insulina.</p>
            <p><strong>Fórmula:</strong> 1800 ÷ Dose Total Diária = mg/dL reduzidos por 1U de insulina</p>
            <p><strong>Observação:</strong> Existem variações destas regras (450 e 1500) para pacientes mais sensíveis à insulina.</p>
        </div>
    </div>
    
    <!-- Aba 3: Cálculo de Bolus -->
    <div id="bolus" class="tabcontent">
        <h2>Cálculo de Bolus</h2>
        
        <div class="form-group">
            <label for="inputGlicemiaAtual">Glicemia Atual (mg/dL):</label>
            <input type="number" id="inputGlicemiaAtual" placeholder="Digite a glicemia atual" min="40" max="600">
        </div>
        
        <div class="form-group">
            <label for="inputGlicemiaAlvo">Glicemia Alvo (mg/dL):</label>
            <input type="number" id="inputGlicemiaAlvo" placeholder="Digite a glicemia alvo" min="70" max="180" value="100">
        </div>
        
        <div class="form-group">
            <label for="inputCarboidratos">Carboidratos a serem consumidos (g):</label>
            <input type="number" id="inputCarboidratos" placeholder="Digite a quantidade de carboidratos" min="0" max="300" step="0.1">
        </div>
        
        <div class="form-group">
            <label for="inputRazaoIC">Razão Insulina/Carboidrato:</label>
            <input type="number" id="inputRazaoIC" placeholder="g de carboidrato por 1U de insulina" min="1" max="100" step="0.1">
        </div>
        
        <div class="form-group">
            <label for="inputFSI">Fator de Sensibilidade (FSI):</label>
            <input type="number" id="inputFSI" placeholder="mg/dL reduzidos por 1U de insulina" min="1" max="100" step="0.1">
        </div>
        
        <button onclick="calcularBolus()">Calcular Bolus</button>
        
        <div id="resultadosBolus" class="results" style="display: none;">
            <h3>Resultados do Cálculo de Bolus</h3>
            
            <div class="result-item">
                <span class="result-label">Diferença de Glicemia (atual - alvo):</span> 
                <span id="diferencaGlicemia">--</span> mg/dL
            </div>
            
            <div class="result-item">
                <span class="result-label">Bolus de Correção:</span> 
                <span id="bolusCorrecao">--</span> U
            </div>
            
            <div class="result-item">
                <span class="result-label">Bolus Alimentar:</span> 
                <span id="bolusAlimentar">--</span> U
            </div>
            
            <div class="result-item">
                <span class="result-label">Bolus Total:</span> 
                <span id="bolusTotalFinal">--</span> U
            </div>
        </div>
        
        <div class="info-box">
            <h4>Como o cálculo é feito:</h4>
            <p><strong>Bolus de Correção:</strong> Corrige a glicemia elevada</p>
            <p><em>Fórmula:</em> (Glicemia Atual - Glicemia Alvo) ÷ FSI = Unidades de insulina</p>
            <p><strong>Bolus Alimentar:</strong> Cobre os carboidratos a serem consumidos</p>
            <p><em>Fórmula:</em> Quantidade de Carboidratos ÷ Razão IC = Unidades de insulina</p>
            <p><strong>Bolus Total:</strong> Bolus de Correção + Bolus Alimentar</p>
            <p><strong>Observação:</strong> Se a glicemia estiver abaixo do alvo, considere reduzir o bolus alimentar ou consumir carboidratos extras.</p>
        </div>
    </div>
    
    <div class="info-box" style="margin-top: 20px;">
        <h3>Informações Importantes</h3>
        <p><strong>1. Esquemas de Insulinoterapia</strong></p>
        <p>O esquema 70/30 (2 doses diárias) e o esquema basal-bolus (múltiplas doses) têm indicações diferentes. A escolha depende do perfil do paciente, capacidade de automonitoramento, rotina e objetivo glicêmico.</p>
        
        <p><strong>2. Fatores que Afetam a Dose de Insulina</strong></p>
        <p>Além do peso, considere: idade, função renal, resistência insulínica, atividade física, uso de medicamentos (corticoides), presença de infecção/estresse e variação da dieta.</p>
        
        <p><strong>3. Educação do Paciente</strong></p>
        <p>Ensine o paciente sobre técnica de aplicação, rodízio de locais, reconhecimento de hipoglicemia e ajustes em situações especiais (exercício, doença aguda).</p>
        
        <p><strong>4. Monitoramento</strong></p>
        <p>O ajuste de doses deve ser feito com base em padrões glicêmicos, não em valores isolados. Analise tendências por pelo menos 3 dias consecutivos antes de modificar o esquema.</p>
        
        <p><strong>5. Transição de Esquemas</strong></p>
        <p>Ao migrar de um esquema para outro, considere sobreposição para evitar hiperglicemia ou hipoglicemia durante a transição.</p>
    </div>
</div>

<script>
    // Função para alternar entre as abas
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        
        // Esconde todas as abas
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        
        // Remove a classe "active" de todos os botões
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        
        // Mostra a aba atual e adiciona a classe "active" ao botão
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }
    
    // Mostrar/esconder o campo de fator personalizado
    document.getElementById("selectFator").addEventListener("change", function() {
        if (this.value === "-1") {
            document.getElementById("fatorPersonalizadoGroup").style.display = "block";
        } else {
            document.getElementById("fatorPersonalizadoGroup").style.display = "none";
        }
    });
    
    // Função para formatar números com uma casa decimal
    function formatarNumero(valor) {
        return parseFloat(valor).toFixed(1);
    }
    
    // Função para calcular dose baseada no peso
    function calcularPeso() {
        var peso = parseFloat(document.getElementById("inputPeso").value);
        
        // Validar entrada
        if (isNaN(peso) || peso <= 0) {
            alert("Por favor, insira um peso válido.");
            return;
        }
        
        // Obter o fator correto
        var fatorSelect = document.getElementById("selectFator");
        var fator;
        
        if (fatorSelect.value === "-1") {
            fator = parseFloat(document.getElementById("inputFatorPersonalizado").value);
            if (isNaN(fator) || fator <= 0) {
                alert("Por favor, insira um fator personalizado válido.");
                return;
            }
        } else {
            fator = parseFloat(fatorSelect.value);
        }
        
        // Cálculo principal: Peso * Fator = Dose total
        var doseTotal = peso * fator;
        
        // Divisão principal (70% NPH, 30% Regular)
        var doseNPH = doseTotal * 0.7;
        var doseRegular = doseTotal * 0.3;
        
        // Esquema duas doses (2/3 manhã, 1/3 noite)
        var doseManha = doseTotal * (2/3);
        var doseNoite = doseTotal * (1/3);
        
        // Manhã (2/3)
        var nphManha = doseManha * 0.7;
        var regularManha = doseManha * 0.3;
        
        // Noite (1/3)
        var nphNoite = doseNoite * 0.7;
        var regularNoite = doseNoite * 0.3;
        
        // Esquema basal-bolus alternativo (50/50)
        var basal = doseTotal * 0.5;
        var bolusTotal = doseTotal * 0.5;
        
        // Dividir bolus em 3 refeições
        var bolusCafe = bolusTotal * 0.4;  // 40% no café
        var bolusAlmoco = bolusTotal * 0.3;  // 30% no almoço
        var bolusJantar = bolusTotal * 0.3;  // 30% no jantar
        
        // Exibir resultados
        document.getElementById("doseTotalPeso").textContent = formatarNumero(doseTotal);
        document.getElementById("doseNPH").textContent = formatarNumero(doseNPH);
        document.getElementById("doseRegular").textContent = formatarNumero(doseRegular);
        document.getElementById("doseManha").textContent = formatarNumero(doseManha);
        document.getElementById("nphManha").textContent = formatarNumero(nphManha);
        document.getElementById("regularManha").textContent = formatarNumero(regularManha);
        document.getElementById("doseNoite").textContent = formatarNumero(doseNoite);
        document.getElementById("nphNoite").textContent = formatarNumero(nphNoite);
        document.getElementById("regularNoite").textContent = formatarNumero(regularNoite);
        document.getElementById("doseBasal").textContent = formatarNumero(basal);
        document.getElementById("bolusTotal").textContent = formatarNumero(bolusTotal);
        document.getElementById("bolusCafe").textContent = formatarNumero(bolusCafe);
        document.getElementById("bolusAlmoco").textContent = formatarNumero(bolusAlmoco);
        document.getElementById("bolusJantar").textContent = formatarNumero(bolusJantar);
        
        document.getElementById("resultadosPeso").style.display = "block";
    }
    
    // Função para calcular regras 500/1800
    function calcularRegras() {
        var doseTotal = parseFloat(document.getElementById("inputDoseTotal").value);
        
        // Validar entrada
        if (isNaN(doseTotal) || doseTotal <= 0) {
            alert("Por favor, insira uma dose total diária válida.");
            return;
        }
        
        // Regra dos 500 - Razão insulina/carboidrato
        var razaoIC500 = 500 / doseTotal;
        
        // Regra dos 450 - Variação para razão IC
        var razaoIC450 = 450 / doseTotal;
        
        // Regra dos 1800 - Fator de sensibilidade à insulina (FSI) em mg/dL
        var fsi1800 = 1800 / doseTotal;
        
        // Regra dos 1500 - Variação do FSI
        var fsi1500 = 1500 / doseTotal;
        
        // Exibir resultados
        document.getElementById("razaoIC500").textContent = formatarNumero(razaoIC500);
        document.getElementById("razaoIC450").textContent = formatarNumero(razaoIC450);
        document.getElementById("fsi1800").textContent = formatarNumero(fsi1800);
        document.getElementById("fsi1500").textContent = formatarNumero(fsi1500);
        
        document.getElementById("resultadosRegras").style.display = "block";
    }
    
    // Função para calcular bolus
    function calcularBolus() {
        var glicemiaAtual = parseFloat(document.getElementById("inputGlicemiaAtual").value);
        var glicemiaAlvo = parseFloat(document.getElementById("inputGlicemiaAlvo").value);
        var carboidratos = parseFloat(document.getElementById("inputCarboidratos").value);
        var razaoIC = parseFloat(document.getElementById("inputRazaoIC").value);
        var fsi = parseFloat(document.getElementById("inputFSI").value);
        
        // Validar entradas
        if (isNaN(glicemiaAtual) || isNaN(glicemiaAlvo) || isNaN(carboidratos) || isNaN(razaoIC) || isNaN(fsi)) {
            alert("Por favor, preencha todos os campos com valores válidos.");
            return;
        }
        
        if (razaoIC <= 0 || fsi <= 0) {
            alert("Razão IC e FSI devem ser maiores que zero.");
            return;
        }
        
        // Cálculo do bolus de correção
        var diferencaGlicemia = Math.max(0, glicemiaAtual - glicemiaAlvo);
        var bolusCorrecao = diferencaGlicemia / fsi;
        
        // Cálculo do bolus alimentar
        var bolusAlimentar = carboidratos / razaoIC;
        
        // Bolus total
        var bolusTotal = bolusCorrecao + bolusAlimentar;
        
        // Exibir resultados
        document.getElementById("diferencaGlicemia").textContent = formatarNumero(diferencaGlicemia);
        document.getElementById("bolusCorrecao").textContent = formatarNumero(bolusCorrecao);
        document.getElementById("bolusAlimentar").textContent = formatarNumero(bolusAlimentar);
        document.getElementById("bolusTotalFinal").textContent = formatarNumero(bolusTotal);
        
        document.getElementById("resultadosBolus").style.display = "block";
    }
</script>
</body>
</html>